<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>HE Cut Pro v18 â€” Dual Views</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
    html,body{font-family:Cairo,system-ui,ui-sans-serif;}
    svg,svg *{user-select:none}
    body{min-height:100vh;transition:background .3s,color .3s}
    body.theme-dark{
      background:
        radial-gradient(circle at top left,rgba(56,189,248,.2),transparent 55%),
        radial-gradient(circle at bottom right,rgba(129,140,248,.25),#020617);
      color:#e5e7eb;
    }
    body.theme-light{background:#ffffff;color:#111827}
    .glass{backdrop-filter:blur(20px)}
    body.theme-dark .glass{background:rgba(15,23,42,.85);border-color:rgba(56,189,248,.3)}
    body.theme-light .glass{background:rgba(255,255,255,.9);border-color:#e5e7eb}
    input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:.5rem;border-radius:999px;background:#0f172a;outline:none}
    body.theme-light input[type=range]{background:#e5e7eb}
    input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none;appearance:none;
      width:20px;height:20px;border-radius:999px;
      background:#38bdf8;border:3px solid #fff;
      box-shadow:0 0 0 4px rgba(56,189,248,.5);cursor:pointer
    }
    .lang-btn{transition:all .2s ease}
    .lang-btn-active{transform:scale(1.1);box-shadow:0 0 0 3px rgba(56,189,248,.4)}
    .field-label-main{font-weight:600;font-size:.9rem}
    .field-label-sub{font-size:.7rem;opacity:.8}
    .tab-btn{
      font-size:.8rem;
      padding:.45rem .85rem;
      border-radius:999px;
      border:1px solid transparent;
      cursor:pointer;
      transition:all .15s ease;
    }
    .tab-btn-active{
      background:linear-gradient(135deg,#0ea5e9,#22c55e);
      color:#0f172a;
      border-color:rgba(15,23,42,.2);
      box-shadow:0 8px 18px rgba(15,23,42,.35);
    }
    .tab-btn-inactive{
      background:rgba(15,23,42,.6);
      color:#e5e7eb;
      border-color:rgba(148,163,184,.5);
    }
    body.theme-light .tab-btn-inactive{
      background:#e5e7eb;
      color:#111827;
      border-color:#cbd5f5;
    }
  </style>
</head>
<body class="text-slate-100 theme-dark">

<header class="border-b border-slate-700/60 bg-slate-900/80 backdrop-blur sticky top-0 z-20">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
    <div>
      <h1 class="text-xl sm:text-2xl font-bold tracking-tight">
        <span data-i18n="appTitle">HE Cut Pro</span>
        <span class="text-sky-400 text-base align-middle">v18 â€” Dual Views</span>
      </h1>
      <p class="text-xs sm:text-sm text-slate-400 mt-0.5" data-i18n="subtitle">
        Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ + ØµÙØ­Ø© Ø§Ù„Ø¬Ù…Ø¹ â€” Ø²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ
      </p>
    </div>
    <div class="flex items-center gap-3">
      <div class="flex items-center gap-2 bg-slate-900/60 border border-slate-600/70 rounded-xl p-1 text-xs">
        <button class="lang-btn lang-btn-active px-2 py-1 rounded-lg hover:bg-sky-500/20" data-lang="ar" title="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">ğŸ‡¸ğŸ‡¦ Ø¹Ø±Ø¨ÙŠ</button>
        <button class="lang-btn px-2 py-1 rounded-lg hover:bg-sky-500/20" data-lang="en" title="English">ğŸ‡ºğŸ‡¸ EN</button>
        <button class="lang-btn px-2 py-1 rounded-lg hover:bg-sky-500/20" data-lang="de" title="Deutsch">ğŸ‡©ğŸ‡ª DE</button>
      </div>
      <button id="themeToggle" class="w-9 h-9 rounded-full border border-slate-600 flex items-center justify-center text-lg bg-slate-900/70 hover:bg-slate-800" title="Toggle theme">â˜¾</button>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-6 sm:py-10 grid grid-cols-1 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1.1fr)] gap-6">

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <section class="glass rounded-2xl shadow-xl shadow-sky-950/50 border border-slate-700/70 p-4 sm:p-5">
    <h2 class="font-semibold text-lg sm:text-xl mb-4" data-i18n="panel1Title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª & Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
    <div class="grid grid-cols-2 gap-3 text-sm">

      <!-- Ø§Ù„Ø³Ù„Ø³Ù„Ø© -->
      <label class="col-span-2 text-slate-300">
        <span class="field-label-main" data-i18n="seriesLabel">Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹</span>
        <span class="field-label-sub text-sky-300/80" data-i18n="seriesHint">HEA / HEB / HEM</span>
      </label>
      <select id="series" class="col-span-2 rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2 focus:outline-none focus:ring-1 focus:ring-sky-400">
        <option value="HEA">HEA</option>
        <option value="HEB" selected>HEB</option>
        <option value="HEM">HEM</option>
      </select>

      <!-- Ø§Ù„Ù…Ù‚Ø§Ø³ -->
      <label class="col-span-2 text-slate-300 mt-2">
        <span class="field-label-main" data-i18n="sizeLabel">Ø§Ù„Ù…Ù‚Ø§Ø³</span>
        <span class="field-label-sub text-slate-400" data-i18n="sizeHint">HE 100 â€¦ HE 400</span>
      </label>
      <select id="size" class="col-span-2 rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2"></select>

      <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø¬Ù†Ø­Ø© -->
      <label class="col-span-2 text-slate-300 mt-2">
        <span class="field-label-main" data-i18n="cutWingsLabel">Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Øµ Ù…Ù† Ø§Ù„Ø²Ø§ÙˆÙŠØ©</span>
        <span class="field-label-sub text-slate-400" data-i18n="cutWingsHint">Ø§Ù„Ø²Ø§ÙˆÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ</span>
      </label>
      <div class="col-span-2 flex flex-wrap gap-3 text-xs text-slate-200">
        <label><input type="radio" name="cutWings" value="top" checked> <span data-i18n="cutModeTop">Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ</span></label>
        <label><input type="radio" name="cutWings" value="bottom"> <span data-i18n="cutModeBottom">Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ</span></label>
        <label><input type="radio" name="cutWings" value="both"> <span data-i18n="cutModeBoth">Ù‚Øµ Ù…Ø³ØªÙ‚Ù„ Ù„Ù„Ø¬Ù†Ø§Ø­ÙŠÙ† (ÙŠØ¯ÙˆÙŠ)</span></label>
      </div>

      <!-- Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‡Ø¯Ù -->
      <label class="col-span-2 text-slate-300 mt-2">
        <span class="field-label-main" data-i18n="angleLabel">Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Î¸ (Ø¯Ø±Ø¬Ø©)</span>
        <span class="field-label-sub text-slate-400" data-i18n="angleHint">ØªØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ù‚ÙŠÙ…Ø© Ù‚Øµ ØªÙ‚Ø±ÙŠØ¨ÙŠØ©</span>
      </label>
      <div class="col-span-2 flex items-center gap-3">
        <input id="angleRange" type="range" min="1" max="45" step="0.5" value="30"/>
        <input id="angle" type="number" min="1" max="45" step="0.5" value="30"
               class="w-16 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center"/>
      </div>

      <!-- Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ÙŠÙ† -->
      <label class="col-span-2 text-slate-300 mt-2">
        <span class="field-label-main" data-i18n="deltaSectionLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ (mm) â€” Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ¬Ù…ÙŠØ¹</span>
      </label>
      <div>
        <div class="text-xs text-slate-400 mb-1" data-i18n="deltaTopLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Î”top</div>
        <input id="deltaTop" type="number" min="0" step="0.1" value="0"
               class="w-full rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center text-xs"/>
        <input id="deltaTopRange" type="range" min="0" max="200" step="0.5" value="0" class="mt-1"/>
      </div>
      <div>
        <div class="text-xs text-slate-400 mb-1" data-i18n="deltaBottomLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Î”bottom</div>
        <input id="deltaBottom" type="number" min="0" step="0.1" value="0"
               class="w-full rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center text-xs"/>
        <input id="deltaBottomRange" type="range" min="0" max="200" step="0.5" value="0" class="mt-1"/>
      </div>

      <!-- Ù…ÙŠÙ„Ø§Ù† -->
      <label class="col-span-2 text-slate-300 mt-3">
        <span class="field-label-main" data-i18n="slopeSectionLabel">Ù…ÙŠÙ„Ø§Ù† Ø®Ø· Ø§Ù„Ù‚Øµ ÙÙŠ Ø§Ù„Ø±Ø³Ù… (Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ)</span>
        <span class="field-label-sub text-amber-300" data-i18n="slopeSectionHint">Ø­Ø± Ù„ÙƒÙ„ Ø¬Ù†Ø§Ø­ â€” ØªÙ…Ø«ÙŠÙ„ Ø¨ØµØ±ÙŠ ÙÙ‚Ø·</span>
      </label>
      <div class="col-span-2 grid grid-cols-2 gap-3 text-xs">
        <div>
          <div class="text-slate-400 mb-1" data-i18n="alphaTopTitle">Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ</div>
          <div class="flex items-center gap-2">
            <input id="alphaTopRange" type="range" min="0" max="60" step="1" value="0"/>
            <input id="alphaTop" type="number" min="0" max="60" step="1" value="0"
                   class="w-14 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center"/>
          </div>
        </div>
        <div>
          <div class="text-slate-400 mb-1" data-i18n="alphaBottomTitle">Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ</div>
          <div class="flex items-center gap-2">
            <input id="alphaBottomRange" type="range" min="0" max="60" step="1" value="0"/>
            <input id="alphaBottom" type="number" min="0" max="60" step="1" value="0"
                   class="w-14 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center"/>
          </div>
        </div>
      </div>

      <!-- Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙŠÙ„Ø§Ù† -->
      <label class="col-span-2 text-slate-300 mt-3">
        <span class="field-label-main" data-i18n="tiltDirSectionLabel">Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙŠÙ„Ø§Ù† (Ø±Ø³Ù… ÙÙ‚Ø·)</span>
        <span class="field-label-sub text-slate-400" data-i18n="tiltDirSectionHint">Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</span>
      </label>
      <div class="col-span-2 grid grid-cols-2 gap-3 text-xs text-slate-200">
        <div>
          <div class="mb-1 text-slate-400" data-i18n="tiltTopLabel">Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ</div>
          <div class="flex gap-2">
            <label><input type="radio" name="tiltDirTop" value="in" checked> <span data-i18n="tiltIn">Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·</span></label>
            <label><input type="radio" name="tiltDirTop" value="out"> <span data-i18n="tiltOut">Ø®Ø§Ø±Ø¬</span></label>
          </div>
        </div>
        <div>
          <div class="mb-1 text-slate-400" data-i18n="tiltBottomLabel">Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø³ÙÙ„ÙŠ</div>
          <div class="flex gap-2">
            <label><input type="radio" name="tiltDirBottom" value="in" checked> <span data-i18n="tiltIn">Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·</span></label>
            <label><input type="radio" name="tiltDirBottom" value="out"> <span data-i18n="tiltOut">Ø®Ø§Ø±Ø¬</span></label>
          </div>
        </div>
      </div>
    </div>

    <!-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
    <div class="mt-5 rounded-xl border border-slate-700/80 bg-slate-900/70 px-3.5 py-3 text-sm" id="readout"></div>
    <div class="mt-4">
      <button id="btnReset"
              class="px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-sm border border-slate-600"
              data-i18n="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·</button>
    </div>
    <p class="text-[11px] text-slate-400 mt-3" data-i18n="theoryText">
      Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©: Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠÙ† Ù‚Ø·Ø¹ØªÙŠÙ† ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ |Î”top âˆ’ Î”bottom| Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ.
    </p>
  </section>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø³Ù… Ù…Ø¹ ØªØ¨ÙˆÙŠØ¨ÙŠÙ† -->
  <section class="glass rounded-2xl shadow-xl shadow-sky-950/50 border border-slate-700/70 p-4 sm:p-5 flex flex-col">
    <div class="flex items-center justify-between mb-4">
      <h2 class="font-semibold text-lg sm:text-xl" data-i18n="panel2Title">Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ØµØ±ÙŠ</h2>
      <div class="flex gap-2">
        <button id="tabFront" class="tab-btn tab-btn-active" data-view="front" data-i18n="tabFront">
          Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©
        </button>
        <button id="tabJoint" class="tab-btn tab-btn-inactive" data-view="joint" data-i18n="tabJoint">
          Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ù…Ø¹
        </button>
      </div>
    </div>

    <!-- ØµÙØ­Ø© 1: Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© -->
    <div id="frontPanel" class="flex-1 flex flex-col">
      <div class="flex-1 border border-slate-700/70 rounded-2xl bg-slate-900/70 px-3 py-4 flex items-center justify-center">
        <div id="frontWrapper"></div>
      </div>
      <div class="grid grid-cols-2 gap-3 text-[11px] text-slate-400 mt-4">
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-slate-400/80"></span>
          <span data-i18n="legendFlanges">Ø§Ù„Ø¬Ù†Ø§Ø­Ø§Ù† (Ø¹Ù„ÙˆÙŠ / Ø³ÙÙ„ÙŠ)</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-slate-300"></span>
          <span data-i18n="legendWeb">Ø§Ù„Ø¹Ù…ÙˆØ¯ (web)</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-red-500"></span>
          <span data-i18n="legendCuts">Ø®Ø·ÙˆØ· Ø§Ù„Ù‚Øµ (ØªÙ…Ø«ÙŠÙ„ Ù„Ù…ÙˆØ¶Ø¹ Î”top Ùˆ Î”bottom)</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-full border border-sky-400"></span>
          <span data-i18n="legendNote">Ø§Ù„Ø±Ø³Ù… ØªÙ…Ø«ÙŠÙ„ÙŠ â€” Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‡ÙŠ Ø§Ù„Ù…Ø±Ø¬Ø¹.</span>
        </div>
      </div>
    </div>

    <!-- ØµÙØ­Ø© 2: Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ù…Ø¹ -->
    <div id="jointPanel" class="flex-1 flex flex-col hidden">
      <div class="flex-1 border border-slate-700/70 rounded-2xl bg-slate-900/70 px-3 py-4 flex items-center justify-center">
        <div id="pairWrapper" class="min-h-[210px] w-full flex items-center justify-center"></div>
      </div>
      <p class="text-[11px] text-slate-400 mt-3" data-i18n="pairHint">
        Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªÙˆØ¶Ø­ Ø´ÙƒÙ„ Ù‚Ø·Ø¹ØªÙŠÙ† H Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ ÙˆØ§Ù„Ø¬Ù…Ø¹ Ù…Ù† Ù†ÙØ³ Ø¬Ù‡Ø© Ø§Ù„Ù‚Øµ. Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ù‡Ù†Ø§ Ù†Ø§ØªØ¬Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ ÙÙ‚Ø·.
      </p>
    </div>
  </section>
</main>

<footer class="max-w-6xl mx-auto px-4 pb-6 text-[11px] text-slate-500 flex justify-between">
  <span data-i18n="footerLeft">HE Cut Pro v18 â€” Dual Views</span>
  <span data-i18n="footerRight">Ù„Ù„ØªÙ†ÙÙŠØ°: Ø§Ø¹ØªÙ…Ø¯ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ ÙˆØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø©.</span>
</footer>

<!-- Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª -->
<script>
  const I18N = {
    ar: {
      appTitle:"HE Cut Pro",
      subtitle:"Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ + ØµÙØ­Ø© Ø§Ù„Ø¬Ù…Ø¹ â€” Ø²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ",
      panel1Title:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª & Ø§Ù„Ø­Ø³Ø§Ø¨",
      panel2Title:"Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ØµØ±ÙŠ",
      seriesLabel:"Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹",
      seriesHint:"HEA / HEB / HEM",
      sizeLabel:"Ø§Ù„Ù…Ù‚Ø§Ø³",
      sizeHint:"HE 100 â€¦ HE 400",
      cutWingsLabel:"Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Øµ Ù…Ù† Ø§Ù„Ø²Ø§ÙˆÙŠØ©",
      cutWingsHint:"Ø§Ù„Ø²Ø§ÙˆÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ",
      cutModeTop:"Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ",
      cutModeBottom:"Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ",
      cutModeBoth:"Ù‚Øµ Ù…Ø³ØªÙ‚Ù„ Ù„Ù„Ø¬Ù†Ø§Ø­ÙŠÙ† (ÙŠØ¯ÙˆÙŠ)",
      angleLabel:"Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Î¸ (Ø¯Ø±Ø¬Ø©)",
      angleHint:"ØªØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ù‚ÙŠÙ…Ø© Ù‚Øµ ØªÙ‚Ø±ÙŠØ¨ÙŠØ©",
      deltaSectionLabel:"Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ (mm) â€” Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ¬Ù…ÙŠØ¹",
      deltaTopLabel:"Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Î”top",
      deltaBottomLabel:"Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Î”bottom",
      slopeSectionLabel:"Ù…ÙŠÙ„Ø§Ù† Ø®Ø· Ø§Ù„Ù‚Øµ ÙÙŠ Ø§Ù„Ø±Ø³Ù… (Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ)",
      slopeSectionHint:"Ø­Ø± Ù„ÙƒÙ„ Ø¬Ù†Ø§Ø­ â€” ØªÙ…Ø«ÙŠÙ„ Ø¨ØµØ±ÙŠ ÙÙ‚Ø·",
      alphaTopTitle:"Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ",
      alphaBottomTitle:"Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ",
      tiltDirSectionLabel:"Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙŠÙ„Ø§Ù† (Ø±Ø³Ù… ÙÙ‚Ø·)",
      tiltDirSectionHint:"Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ",
      tiltTopLabel:"Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ",
      tiltBottomLabel:"Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø³ÙÙ„ÙŠ",
      tiltIn:"Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·",
      tiltOut:"Ø®Ø§Ø±Ø¬",
      resetBtn:"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·",
      theoryText:"Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©: Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠÙ† Ù‚Ø·Ø¹ØªÙŠÙ† ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ |Î”top âˆ’ Î”bottom| Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ.",
      legendFlanges:"Ø§Ù„Ø¬Ù†Ø§Ø­Ø§Ù† (Ø¹Ù„ÙˆÙŠ / Ø³ÙÙ„ÙŠ)",
      legendWeb:"Ø§Ù„Ø¹Ù…ÙˆØ¯ (web)",
      legendCuts:"Ø®Ø·ÙˆØ· Ø§Ù„Ù‚Øµ (ØªÙ…Ø«ÙŠÙ„ Ù„Ù…ÙˆØ¶Ø¹ Î”top Ùˆ Î”bottom)",
      legendNote:"Ø§Ù„Ø±Ø³Ù… ØªÙ…Ø«ÙŠÙ„ÙŠ â€” Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‡ÙŠ Ø§Ù„Ù…Ø±Ø¬Ø¹.",
      tabFront:"Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©",
      tabJoint:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ù…Ø¹",
      footerLeft:"HE Cut Pro v18 â€” Dual Views",
      footerRight:"Ù„Ù„ØªÙ†ÙÙŠØ°: Ø§Ø¹ØªÙ…Ø¯ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ ÙˆØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø©.",
      summaryTitle:"Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨",
      profileLabel:"Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„",
      flangeWidthLabel:"Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ù†Ø§Ø­ b (ØªÙ‚Ø±ÙŠØ¨ÙŠ)",
      assemblyAngleLabel:"Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ø§ØªØ¬Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ",
      diffLabel:"Ø§Ù„ÙØ±Ù‚ |Î”top âˆ’ Î”bottom|",
      remainingTopLabel:"Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ",
      remainingBottomLabel:"Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ",
      frontAngleCaption:"Î¸ Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ· Ù‡ÙŠ Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù†Ø¸Ø±ÙŠØ©. Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ ØªØ£ØªÙŠ Ù…Ù† ÙØ±Ù‚ Î”top Ùˆ Î”bottom.",
      pairTitle:"Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ù…Ø¹ â€” Ø±Ø¤ÙŠØ© Ø£Ù…Ø§Ù…ÙŠØ©",
      pairHint:"Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªÙˆØ¶Ø­ Ø´ÙƒÙ„ Ù‚Ø·Ø¹ØªÙŠÙ† H Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ ÙˆØ§Ù„Ø¬Ù…Ø¹ Ù…Ù† Ù†ÙØ³ Ø¬Ù‡Ø© Ø§Ù„Ù‚Øµ. Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ù‡Ù†Ø§ Ù†Ø§ØªØ¬Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ ÙÙ‚Ø·.",
      pairZeroNote:"Î”top â‰ˆ Î”bottom â‡’ Ø§Ù„Ù‚Ø·Ø¹ØªØ§Ù† Ø¹Ù„Ù‰ Ø§Ø³ØªÙ‚Ø§Ù…Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ (Ø²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ â‰ˆ 0Â°).",
      pairAngleText:"Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø·Ø¹ØªÙŠÙ†:"
    },
    en: {
      appTitle:"HE Cut Pro",
      subtitle:"Front View + Joint View â€” Assembly Angle from Cut Difference",
      panel1Title:"Settings & Calculation",
      panel2Title:"Visual Display",
      seriesLabel:"Section Series",
      seriesHint:"HEA / HEB / HEM",
      sizeLabel:"Size",
      sizeHint:"HE 100 â€¦ HE 400",
      cutWingsLabel:"Flanges used in angle â†’ cut calculation",
      cutWingsHint:"Angle depends on cut difference between top & bottom",
      cutModeTop:"Cut on top flange",
      cutModeBottom:"Cut on bottom flange",
      cutModeBoth:"Independent cuts (manual)",
      angleLabel:"Target assembly angle Î¸ (deg)",
      angleHint:"Used only to suggest a cut value",
      deltaSectionLabel:"Flange cut (mm) â€” per piece before assembly",
      deltaTopLabel:"Top flange cut Î”top",
      deltaBottomLabel:"Bottom flange cut Î”bottom",
      slopeSectionLabel:"Cut line tilt in drawing (from vertical)",
      slopeSectionHint:"Free per flange â€” visual only",
      alphaTopTitle:"Top cut line tilt angle",
      alphaBottomTitle:"Bottom cut line tilt angle",
      tiltDirSectionLabel:"Tilt direction (drawing only)",
      tiltDirSectionHint:"Does not affect calculations",
      tiltTopLabel:"Top tilt direction",
      tiltBottomLabel:"Bottom tilt direction",
      tiltIn:"Towards center",
      tiltOut:"Outwards",
      resetBtn:"Reset",
      theoryText:"Engineering idea: the assembly angle between two pieces depends on |Î”top âˆ’ Î”bottom|, the cut difference between top and bottom flanges.",
      legendFlanges:"Flanges (top / bottom)",
      legendWeb:"Web",
      legendCuts:"Cut lines (showing Î”top and Î”bottom positions)",
      legendNote:"Drawing is representative â€” numeric values in the summary are the reference.",
      tabFront:"Single piece",
      tabJoint:"After joining",
      footerLeft:"HE Cut Pro v18 â€” Dual Views",
      footerRight:"For execution: refer to section catalog & workshop instructions.",
      summaryTitle:"Calculation Summary",
      profileLabel:"Profile",
      flangeWidthLabel:"Flange width b (approx)",
      assemblyAngleLabel:"Assembly angle from cut difference",
      diffLabel:"Difference |Î”top âˆ’ Î”bottom|",
      remainingTopLabel:"Remaining top flange width after cut",
      remainingBottomLabel:"Remaining bottom flange width after cut",
      frontAngleCaption:"Î¸ from the slider is the target angle. Actual assembly angle comes from Î”top vs Î”bottom.",
      pairTitle:"Result after joining â€” Front view",
      pairHint:"This page shows two H-pieces after cutting and joining from the same cut side. The assembly angle comes only from the cut difference between top and bottom flanges.",
      pairZeroNote:"Î”top â‰ˆ Î”bottom â‡’ pieces are almost aligned (assembly angle â‰ˆ 0Â°).",
      pairAngleText:"Approximate assembly angle between pieces:"
    },
    de: {
      appTitle:"HE Cut Pro",
      subtitle:"Vorderansicht + FÃ¼geansicht â€” Montagewinkel aus Schnittdifferenz",
      panel1Title:"Einstellungen & Berechnung",
      panel2Title:"Visuelle Darstellung",
      seriesLabel:"Profilserie",
      seriesHint:"HEA / HEB / HEM",
      sizeLabel:"GrÃ¶ÃŸe",
      sizeHint:"HE 100 â€¦ HE 400",
      cutWingsLabel:"Flansche fÃ¼r Winkelâ†’Schnitt-Berechnung",
      cutWingsHint:"Winkel hÃ¤ngt von Schnittdifferenz oben/unten ab",
      cutModeTop:"Schnitt am oberen Flansch",
      cutModeBottom:"Schnitt am unteren Flansch",
      cutModeBoth:"UnabhÃ¤ngige Schnitte (manuell)",
      angleLabel:"Zielmontagewinkel Î¸ (Grad)",
      angleHint:"Nur zur Vorschlag eines Schnittwertes",
      deltaSectionLabel:"Flanschschnitt (mm) â€” pro Teil vor Montage",
      deltaTopLabel:"Oberer Flanschschnitt Î”top",
      deltaBottomLabel:"Unterer Flanschschnitt Î”bottom",
      slopeSectionLabel:"Schnittlinienneigung in Zeichnung (von vertikal)",
      slopeSectionHint:"Frei pro Flansch â€” nur visuell",
      alphaTopTitle:"Neigungswinkel der oberen Schnittlinie",
      alphaBottomTitle:"Neigungswinkel der unteren Schnittlinie",
      tiltDirSectionLabel:"Neigungsrichtung (nur Zeichnung)",
      tiltDirSectionHint:"Beeinflusst Berechnung nicht",
      tiltTopLabel:"Neigungsrichtung oben",
      tiltBottomLabel:"Neigungsrichtung unten",
      tiltIn:"Zur Mitte",
      tiltOut:"Nach auÃŸen",
      resetBtn:"ZurÃ¼cksetzen",
      theoryText:"Ingenieuridee: Der Montagewinkel zwischen zwei Teilen hÃ¤ngt von |Î”top âˆ’ Î”bottom| ab, der Schnittdifferenz zwischen oberem und unterem Flansch.",
      legendFlanges:"Flansche (oben / unten)",
      legendWeb:"Steg",
      legendCuts:"Schnittlinien (Position von Î”top und Î”bottom)",
      legendNote:"Zeichnung ist reprÃ¤sentativ â€” maÃŸgeblich sind die numerischen Werte.",
      tabFront:"Einzelteil",
      tabJoint:"Nach dem FÃ¼gen",
      footerLeft:"HE Cut Pro v18 â€” Dual Views",
      footerRight:"FÃ¼r AusfÃ¼hrung: Profilkatalog & Werkstattanweisungen beachten.",
      summaryTitle:"BerechnungsÃ¼bersicht",
      profileLabel:"Profil",
      flangeWidthLabel:"Flanschbreite b (ca.)",
      assemblyAngleLabel:"Montagewinkel aus Schnittdifferenz",
      diffLabel:"Differenz |Î”top âˆ’ Î”bottom|",
      remainingTopLabel:"Verbleibende Breite oben nach Schnitt",
      remainingBottomLabel:"Verbleibende Breite unten nach Schnitt",
      frontAngleCaption:"Î¸ aus dem Schieber ist Zielwinkel. Der tatsÃ¤chliche Winkel ergibt sich aus Î”top und Î”bottom.",
      pairTitle:"Ergebnis nach dem FÃ¼gen â€” Vorderansicht",
      pairHint:"Diese Seite zeigt zwei H-Teile nach Schnitt und FÃ¼gen von derselben Seite. Der Montagewinkel entsteht nur aus der Schnittdifferenz zwischen oberem und unterem Flansch.",
      pairZeroNote:"Î”top â‰ˆ Î”bottom â‡’ Teile nahezu fluchtend (Montagewinkel â‰ˆ 0Â°).",
      pairAngleText:"UngefÃ¤hrer Montagewinkel zwischen den Teilen:"
    }
  };
</script>

<script>
  const HE_DATA={
    HEA:{100:{b:100},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:280},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}},
    HEB:{100:{b:100},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:280},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}},
    HEM:{100:{b:120},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:260},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}}
  };
  const CALIB=1.0339;

  const $series=document.getElementById('series');
  const $size=document.getElementById('size');
  const $angle=document.getElementById('angle');
  const $angleRange=document.getElementById('angleRange');
  const $deltaTop=document.getElementById('deltaTop');
  const $deltaBottom=document.getElementById('deltaBottom');
  const $deltaTopRange=document.getElementById('deltaTopRange');
  const $deltaBottomRange=document.getElementById('deltaBottomRange');
  const $alphaTop=document.getElementById('alphaTop');
  const $alphaTopRange=document.getElementById('alphaTopRange');
  const $alphaBottom=document.getElementById('alphaBottom');
  const $alphaBottomRange=document.getElementById('alphaBottomRange');
  const $readout=document.getElementById('readout');
  const $frontWrapper=document.getElementById('frontWrapper');
  const $pairWrapper=document.getElementById('pairWrapper');
  const $btnReset=document.getElementById('btnReset');
  const $themeToggle=document.getElementById('themeToggle');
  const $tabFront=document.getElementById('tabFront');
  const $tabJoint=document.getElementById('tabJoint');
  const $frontPanel=document.getElementById('frontPanel');
  const $jointPanel=document.getElementById('jointPanel');

  let mode='angle';
  let currentLang='ar';

  function getCutMode(){return document.querySelector('input[name="cutWings"]:checked')?.value||'top';}
  function getTiltDirTop(){const c=document.querySelector('input[name="tiltDirTop"]:checked');return c?c.value:'in';}
  function getTiltDirBottom(){const c=document.querySelector('input[name="tiltDirBottom"]:checked');return c?c.value:'in';}

  function populateSizes(){
    const s=$series.value;
    const sizes=Object.keys(HE_DATA[s]).map(Number).sort((a,b)=>a-b);
    $size.innerHTML=sizes.map(v=>`<option value="${v}" ${v===180?'selected':''}>${v}</option>`).join('');
  }

  function angleFromCuts(dt,db,b){
    if(b<=0)return 0;
    const diff=Math.abs(dt-db);
    if(diff<0.001)return 0;
    return 2*Math.atan(diff/(b*CALIB))*180/Math.PI;
  }

  function applyTranslations(lang){
    currentLang=lang;
    const dict=I18N[lang]||I18N.ar;
    document.documentElement.lang=lang;
    document.documentElement.dir=(lang==='ar')?'rtl':'ltr';
    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const k=el.getAttribute('data-i18n');
      if(dict[k]) el.innerHTML=dict[k];
    });
    document.querySelectorAll('.lang-btn').forEach(btn=>{
      btn.classList.toggle('lang-btn-active',btn.dataset.lang===lang);
    });
    calc();
  }

  function calc(){
    const dict=I18N[currentLang]||I18N.ar;
    const s=$series.value;
    const sz=Number($size.value);
    const cutMode=getCutMode();
    const tiltDirTop=getTiltDirTop();
    const tiltDirBottom=getTiltDirBottom();
    const data=HE_DATA[s][sz]||{b:180};
    const b=data.b;

    const maxCut=Math.round(b*0.6);
    $deltaTopRange.max=maxCut;
    $deltaBottomRange.max=maxCut;

    let angDeg=Number($angle.value);
    let dt=Number($deltaTop.value);
    let db=Number($deltaBottom.value);
    let alphaTopDeg=Number($alphaTop.value);
    let alphaBottomDeg=Number($alphaBottom.value);

    if(isNaN(dt))dt=0;if(isNaN(db))db=0;
    if(isNaN(alphaTopDeg))alphaTopDeg=0;if(isNaN(alphaBottomDeg))alphaBottomDeg=0;
    alphaTopDeg=Math.max(0,Math.min(60,alphaTopDeg));
    alphaBottomDeg=Math.max(0,Math.min(60,alphaBottomDeg));
    $alphaTop.value=alphaTopDeg.toFixed(0);
    $alphaTopRange.value=alphaTopDeg;
    $alphaBottom.value=alphaBottomDeg.toFixed(0);
    $alphaBottomRange.value=alphaBottomDeg;

    if(mode==='angle'){
      if(!isFinite(angDeg)||angDeg<1)angDeg=1;
      if(angDeg>45)angDeg=45;
      const halfRad=(angDeg*Math.PI/180)/2;
      const deltaGeom=Math.min(maxCut,b*Math.tan(halfRad)*CALIB);
      if(cutMode==='top'){dt=deltaGeom;db=0;}
      else if(cutMode==='bottom'){dt=0;db=deltaGeom;}
      else {dt=deltaGeom;db=0;}
    }else{
      dt=Math.max(0,Math.min(dt,maxCut));
      db=Math.max(0,Math.min(db,maxCut));
      angDeg=Math.min(60,Math.max(0,angleFromCuts(dt,db,b)));
    }

    $angle.value=angDeg.toFixed(1);
    $angleRange.value=angDeg;
    $deltaTop.value=dt.toFixed(1);
    $deltaBottom.value=db.toFixed(1);
    $deltaTopRange.value=dt;
    $deltaBottomRange.value=db;

    const pairAngle=angleFromCuts(dt,db,b);
    const remainingTop=Math.max(b-dt,0);
    const remainingBottom=Math.max(b-db,0);
    const diffCut=Math.abs(dt-db);

    const labelSummary=dict.summaryTitle||'Summary';
    const labelProfile=dict.profileLabel||'Profile';
    const labelB=dict.flangeWidthLabel||'Flange width b';
    const labelAsm=dict.assemblyAngleLabel||'Assembly angle';
    const labelDiff=dict.diffLabel||'Difference';
    const labelRemT=dict.remainingTopLabel||'Remaining top';
    const labelRemB=dict.remainingBottomLabel||'Remaining bottom';

    $readout.innerHTML=`
      <div class="text-sky-300 text-xs mb-1">${labelSummary}</div>
      <div class="grid grid-cols-2 gap-x-3 gap-y-1 text-xs">
        <div>${labelProfile}:</div><div class="text-right"><b>${s} ${sz}</b></div>
        <div>${labelB}:</div><div class="text-right"><b>${b.toFixed(0)} mm</b></div>
        <div>${labelAsm}:</div><div class="text-right text-sky-300"><b>${pairAngle.toFixed(2)}Â°</b></div>
        <div>Î”top:</div><div class="text-right text-emerald-300"><b>${dt.toFixed(1)} mm</b></div>
        <div>Î”bottom:</div><div class="text-right text-emerald-300"><b>${db.toFixed(1)} mm</b></div>
        <div>${labelDiff}:</div><div class="text-right text-amber-300"><b>${diffCut.toFixed(1)} mm</b></div>
        <div>${labelRemT}:</div><div class="text-right"><b>${remainingTop.toFixed(1)} mm</b></div>
        <div>${labelRemB}:</div><div class="text-right"><b>${remainingBottom.toFixed(1)} mm</b></div>
      </div>
      <div class="text-[10px] text-slate-400 mt-2">
        ${dict.frontAngleCaption || ''}
      </div>
    `;

    renderFront({dict,s,sz,b,angDeg,dt,db,alphaTopDeg,alphaBottomDeg,tiltDirTop,tiltDirBottom});
    renderJoint({dict,s,sz,b,angle:pairAngle,dt,db});
  }

  function renderFront({dict,s,sz,b,angDeg,dt,db,alphaTopDeg,alphaBottomDeg,tiltDirTop,tiltDirBottom}){
    const w=320,h=260,pad=30;
    const midX=w/2,topY=pad,botY=h-pad;
    const scale=Math.min(1.1,Math.max(0.7,sz/220));
    const ph=200*scale,th=Math.max(18,ph*0.18),wh=Math.max(12,ph*0.12);
    const cy=(topY+botY)/2;
    const tfy=cy-ph/2,bfy=cy+ph/2;
    const span=70+(b-180)*0.25;
    const fl=midX-span,fr=midX+span,fw=fr-fl;

    const ft=b>0?dt/b:0,fb=b>0?db/b:0;
    const cutXTop=fr-ft*fw,cutXBottom=fr-fb*fw;

    const phiTopRad=alphaTopDeg*Math.PI/180;
    const phiBottomRad=alphaBottomDeg*Math.PI/180;
    const dirSignTop=tiltDirTop==='in'?-1:1;
    const dirSignBottom=tiltDirBottom==='in'?-1:1;
    const dxTop=Math.tan(phiTopRad)*th*dirSignTop;
    const dxBottom=Math.tan(phiBottomRad)*th*dirSignBottom;

    const angleLabel=(currentLang==='ar'?'Î¸ Ø§Ù„Ù‡Ø¯Ù':'Î¸ target');

    const svg=`
    <svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}">
      <defs>
        <linearGradient id="mg" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#cbd5f5"/><stop offset="40%" stop-color="#e5e7eb"/>
          <stop offset="70%" stop-color="#9ca3af"/><stop offset="100%" stop-color="#6b7280"/>
        </linearGradient>
        <filter id="sh" x="-20%" y="-20%" width="140%" height="140%">
          <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#020617" flood-opacity="0.8"/>
        </filter>
      </defs>
      <g filter="url(#sh)">
        <rect x="${fl}" y="${tfy}" width="${fw}" height="${th}" fill="url(#mg)" stroke="#94a3b8" stroke-width="1"/>
        <rect x="${fl}" y="${bfy-th}" width="${fw}" height="${th}" fill="url(#mg)" stroke="#94a3b8" stroke-width="1"/>
        <rect x="${midX-wh/2}" y="${tfy+th}" width="${wh}" height="${ph-2*th}" fill="#e5e7eb" stroke="#94a3b8" stroke-width="1"/>
      </g>
      ${dt>0.1?`<line x1="${cutXTop}" y1="${tfy}" x2="${cutXTop+dxTop}" y2="${tfy+th}" stroke="#f97373" stroke-width="4" stroke-linecap="round"/>`:''}
      ${db>0.1?`<line x1="${cutXBottom}" y1="${bfy-th}" x2="${cutXBottom+dxBottom}" y2="${bfy}" stroke="#f97373" stroke-width="4" stroke-linecap="round"/>`:''}
      <text x="${midX}" y="${tfy-12}" font-size="13" fill="#e5e7eb" text-anchor="middle" font-weight="600">${s} ${sz}</text>
      <text x="${midX}" y="${bfy+18}" font-size="11" fill="#fda4af" text-anchor="middle" font-weight="600">
        ${angleLabel}: ${angDeg.toFixed(1)}Â°
      </text>
    </svg>`;
    $frontWrapper.innerHTML=svg;
  }

  function renderJoint({dict,s,sz,b,angle,dt,db}){
    const w=420,h=220;
    const cx=w/2,cy=h/2+4;
    const theta=Math.min(80,Math.max(0,angle||0));
    const half=theta/2;

    const span=120;
    const ph=130,th=16,wh=10;
    const topY=-ph/2,botY=ph/2;
    const webOffsetX=20;

    const leftProfile=`
      <rect x="0" y="${topY}" width="${span}" height="${th}" fill="url(#mg2)" stroke="#94a3b8" stroke-width="1"/>
      <rect x="0" y="${botY-th}" width="${span}" height="${th}" fill="url(#mg2)" stroke="#94a3b8" stroke-width="1"/>
      <rect x="${webOffsetX}" y="${topY+th}" width="${wh}" height="${ph-2*th}" fill="#e5e7eb" stroke="#94a3b8" stroke-width="1"/>
    `;

    const rightProfile=leftProfile;

    const angleText = theta===0 ? (dict.pairZeroNote||'Pieces aligned (no angle).')
                                : `${dict.pairAngleText||'Angle:'} ${theta.toFixed(2)}Â°`;

    const gapPx = 4; // ÙØ§ØµÙ„ ØµØºÙŠØ± ØªÙ…Ø«ÙŠÙ„ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø·Ø¹ØªÙŠÙ†

    const svg=`
    <svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}">
      <defs>
        <linearGradient id="mg2" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#cbd5f5"/><stop offset="40%" stop-color="#e5e7eb"/>
          <stop offset="70%" stop-color="#9ca3af"/><stop offset="100%" stop-color="#6b7280"/>
        </linearGradient>
        <filter id="sh2" x="-20%" y="-20%" width="140%" height="140%">
          <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#020617" flood-opacity="0.85"/>
        </filter>
      </defs>

      <g filter="url(#sh2)">
        <!-- Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙŠØ³Ø±Ù‰ -->
        <g transform="translate(${cx-gapPx},${cy}) rotate(${-half})">
          ${leftProfile}
        </g>
        <!-- Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ -->
        <g transform="translate(${cx+gapPx},${cy}) rotate(${half}) scale(-1,1)">
          ${rightProfile}
        </g>
      </g>

      <!-- Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ø¹Ù†Ø¯ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ¬Ù…ÙŠØ¹ -->
      <circle cx="${cx}" cy="${cy}" r="3.2" fill="#f97373"/>

      <!-- Ù‚ÙˆØ³ Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø·Ø¹ØªÙŠÙ† -->
      <path d="
        M ${cx + 40} ${cy}
        A 40 40 0 0 0 ${cx + 40*Math.cos(theta*Math.PI/180)} ${cy - 40*Math.sin(theta*Math.PI/180)}
      " fill="none" stroke="#f97373" stroke-width="2" stroke-linecap="round"/>

      <text x="${cx + 50}" y="${cy-8}" font-size="11" fill="#fda4af" font-weight="600">
        Î¸ â‰ˆ ${theta.toFixed(1)}Â°
      </text>

      <text x="${w/2}" y="22" font-size="13" fill="#e5e7eb" text-anchor="middle" font-weight="600">
        ${s} ${sz} â€” ${dict.pairTitle||'After joining'}
      </text>
      <text x="${w/2}" y="${h-12}" font-size="10" fill="#cbd5f5" text-anchor="middle">
        ${angleText}
      </text>
    </svg>`;
    $pairWrapper.innerHTML=svg;
  }

  // Events
  [$series,$size].forEach(el=>el.addEventListener('input',()=>{mode='angle';calc();}));
  $angle.addEventListener('input',()=>{mode='angle';calc();});
  $angleRange.addEventListener('input',()=>{$angle.value=$angleRange.value;mode='angle';calc();});
  $deltaTop.addEventListener('change',()=>{mode='cuts';$deltaTopRange.value=$deltaTop.value||0;calc();});
  $deltaBottom.addEventListener('change',()=>{mode='cuts';$deltaBottomRange.value=$deltaBottom.value||0;calc();});
  $deltaTopRange.addEventListener('input',()=>{$deltaTop.value=$deltaTopRange.value;mode='cuts';calc();});
  $deltaBottomRange.addEventListener('input',()=>{$deltaBottom.value=$deltaBottomRange.value;mode='cuts';calc();});
  $alphaTop.addEventListener('input',()=>calc());
  $alphaTopRange.addEventListener('input',()=>{$alphaTop.value=$alphaTopRange.value;calc();});
  $alphaBottom.addEventListener('input',()=>calc());
  $alphaBottomRange.addEventListener('input',()=>{$alphaBottom.value=$alphaBottomRange.value;calc();});

  document.querySelectorAll('input[name="tiltDirTop"],input[name="tiltDirBottom"]').forEach(el=>{
    el.addEventListener('change',()=>calc());
  });

  $btnReset.addEventListener('click',()=>{
    mode='angle';
    $series.value='HEB';
    populateSizes();
    $size.value='180';
    $angle.value=30;$angleRange.value=30;
    $deltaTop.value=0;$deltaBottom.value=0;
    $deltaTopRange.value=0;$deltaBottomRange.value=0;
    $alphaTop.value=0;$alphaTopRange.value=0;
    $alphaBottom.value=0;$alphaBottomRange.value=0;
    document.querySelector('input[name="cutWings"][value="top"]').checked=true;
    document.querySelector('input[name="tiltDirTop"][value="in"]').checked=true;
    document.querySelector('input[name="tiltDirBottom"][value="in"]').checked=true;
    calc();
  });

  $themeToggle.addEventListener('click',()=>{
    document.body.classList.toggle('theme-dark');
    document.body.classList.toggle('theme-light');
    $themeToggle.textContent=document.body.classList.contains('theme-dark')?'â˜¾':'â˜€';
  });

  document.querySelectorAll('.lang-btn').forEach(btn=>{
    btn.addEventListener('click',()=>applyTranslations(btn.dataset.lang));
  });

  // ØªØ¨ÙˆÙŠØ¨Ø§Øª (ØµÙØ­Ø© Ø§Ù„Ù‚Ø·Ø¹Ø© / ØµÙØ­Ø© Ø§Ù„Ø¬Ù…Ø¹)
  function activateTab(view){
    if(view==='front'){
      $frontPanel.classList.remove('hidden');
      $jointPanel.classList.add('hidden');
      $tabFront.classList.add('tab-btn-active');$tabFront.classList.remove('tab-btn-inactive');
      $tabJoint.classList.remove('tab-btn-active');$tabJoint.classList.add('tab-btn-inactive');
    }else{
      $frontPanel.classList.add('hidden');
      $jointPanel.classList.remove('hidden');
      $tabJoint.classList.add('tab-btn-active');$tabJoint.classList.remove('tab-btn-inactive');
      $tabFront.classList.remove('tab-btn-active');$tabFront.classList.add('tab-btn-inactive');
    }
  }
  $tabFront.addEventListener('click',()=>activateTab('front'));
  $tabJoint.addEventListener('click',()=>activateTab('joint'));

  document.addEventListener('DOMContentLoaded',()=>{
    populateSizes();
    document.getElementById('size').value='180';
    applyTranslations('ar');
    activateTab('front');
  });
</script>

</body>
</html>

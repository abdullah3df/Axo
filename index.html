<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>HE Cut Pro v21 â€” Dual Front View</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
    html,body{
      font-family:Cairo,system-ui,ui-sans-serif;
    }
    svg,svg *{user-select:none}
    body{
      min-height:100vh;
      transition:background .3s,color .3s;
      overflow-x:hidden;
    }
    body.theme-dark{
      background:
        radial-gradient(circle at top left,rgba(56,189,248,.2),transparent 55%),
        radial-gradient(circle at bottom right,rgba(129,140,248,.25),#020617);
      color:#e5e7eb;
    }
    body.theme-light{
      background:#f9fafb;
      color:#111827;
    }
    .glass{
      backdrop-filter:blur(20px);
    }
    body.theme-dark .glass{
      background:rgba(15,23,42,.88);
      border-color:rgba(56,189,248,.32);
    }
    body.theme-light .glass{
      background:rgba(255,255,255,.9);
      border-color:#e5e7eb;
    }

    input[type=range]{
      -webkit-appearance:none;
      appearance:none;
      width:100%;
      height:.5rem;
      border-radius:999px;
      background:#0f172a;
      outline:none;
    }
    body.theme-light input[type=range]{background:#e5e7eb}
    input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width:18px;height:18px;
      border-radius:999px;
      background:#38bdf8;
      border:2px solid #fff;
      box-shadow:0 0 0 4px rgba(56,189,248,.5);
      cursor:pointer;
    }
    input[type=range]::-moz-range-thumb{
      width:18px;height:18px;
      border-radius:999px;
      background:#38bdf8;
      border:2px solid #fff;
      box-shadow:0 0 0 4px rgba(56,189,248,.5);
      cursor:pointer;
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
    .lang-switcher{
      display:flex;
      align-items:center;
      gap:.4rem;
      padding:.15rem .45rem;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.5);
      background:rgba(15,23,42,.7);
    }
    body.theme-light .lang-switcher{
      background:rgba(255,255,255,.9);
      border-color:#e5e7eb;
    }
    .lang-switcher-icon{
      font-size:.75rem;
      opacity:.9;
    }
    .lang-btn{
      transition:all .18s ease;
      padding:.25rem .6rem;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.4);
      font-size:.7rem;
      display:inline-flex;
      align-items:center;
      gap:.25rem;
      background:transparent;
      cursor:pointer;
      color:#e5e7eb;
    }
    body.theme-light .lang-btn{
      color:#0f172a;
      border-color:rgba(148,163,184,.6);
    }
    .lang-btn:hover{
      background:rgba(148,163,184,.15);
    }
    .lang-btn-active{
      background:linear-gradient(135deg,#38bdf8,#a855f7);
      color:#0f172a;
      border-color:rgba(15,23,42,.8);
      transform:scale(1.03);
      box-shadow:0 0 0 1px rgba(56,189,248,.45);
    }

    .field-label-main{font-weight:600;font-size:.9rem;}
    .field-label-sub{font-size:.7rem;opacity:.8;}

    .tab-btn{
      border-radius:999px;
      padding:.4rem .9rem;
      font-size:.75rem;
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      cursor:pointer;
      border:1px solid transparent;
      transition:all .16s ease;
    }
    .tab-btn-active{
      background:linear-gradient(135deg,#38bdf8,#a855f7);
      color:#0f172a;
      border-color:rgba(15,23,42,.8);
      box-shadow:0 10px 25px rgba(15,23,42,.4);
    }

    .view-hidden{display:none;}

    .pill{
      border-radius:999px;
      padding:.15rem .55rem;
      font-size:.65rem;
    }
  </style>
</head>
<body class="text-slate-100 theme-dark">

<!-- HEADER -->
<header class="border-b border-slate-700/60 bg-slate-900/85 backdrop-blur sticky top-0 z-20">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
    <div>
      <h1 class="text-xl sm:text-2xl font-bold tracking-tight flex items-center gap-2">
        <span data-i18n="appTitle">HE Cut Pro</span>
        <span class="text-sky-400 text-sm sm:text-base align-middle">v21 â€” Dual Front View</span>
      </h1>
      <p class="text-xs sm:text-sm text-slate-400 mt-0.5" data-i18n="subtitle">
        Ù‚Øµ Ø£Ø¬Ù†Ø­Ø© HEA / HEB / HEM â€” Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© + Ø¬Ù…Ø¹ Ù‚Ø·Ø¹ØªÙŠÙ† Ù…Ù† Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
      </p>
    </div>

    <div class="flex items-center gap-3">
      <!-- language -->
      <div class="lang-switcher text-xs">
        <span class="lang-switcher-icon">ğŸŒ</span>
        <button class="lang-btn lang-btn-active" data-lang="ar" title="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">AR</button>
        <button class="lang-btn" data-lang="en" title="English">EN</button>
        <button class="lang-btn" data-lang="de" title="Deutsch">DE</button>
      </div>
      <!-- theme -->
      <button id="themeToggle"
              class="w-9 h-9 rounded-full border border-slate-600 flex items-center justify-center text-lg bg-slate-900/70 hover:bg-slate-800"
              title="Toggle light / dark">â˜¾</button>
    </div>
  </div>
</header>

<!-- MAIN -->
<main class="max-w-6xl mx-auto px-4 py-6 sm:py-10 grid grid-cols-1 lg:grid-cols-[minmax(0,1.05fr)_minmax(0,1.15fr)] gap-6">

  <!-- SETTINGS PANEL -->
  <section class="glass rounded-2xl shadow-xl shadow-sky-950/50 border border-slate-700/70 p-4 sm:p-5">
    <h2 class="font-semibold text-lg sm:text-xl mb-4 flex items-center gap-2">
      <span class="inline-flex h-6 w-6 rounded-full bg-sky-500/20 border border-sky-400/60 items-center justify-center text-[11px]">1</span>
      <span data-i18n="panel1Title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª &amp; Ø§Ù„Ø­Ø³Ø§Ø¨</span>
    </h2>

    <div class="grid grid-cols-2 gap-3 text-sm">

      <!-- SERIES -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5">
        <span class="field-label-main" data-i18n="seriesLabel">Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹</span>
        <span class="field-label-sub text-sky-300/80" data-i18n="seriesHint">HEA / HEB / HEM</span>
      </label>
      <select id="series"
              class="col-span-2 rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2 focus:outline-none focus:ring-1 focus:ring-sky-400">
        <option value="HEA">HEA</option>
        <option value="HEB" selected>HEB</option>
        <option value="HEM">HEM</option>
      </select>

      <!-- SIZE -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5 mt-1">
        <span class="field-label-main" data-i18n="sizeLabel">Ø§Ù„Ù…Ù‚Ø§Ø³</span>
        <span class="field-label-sub text-slate-400" data-i18n="sizeHint">HE 100 â€¦ HE 400 (ØªÙ‚Ø±ÙŠØ¨ÙŠ)</span>
      </label>
      <select id="size"
              class="col-span-2 rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2 focus:outline-none focus:ring-1 focus:ring-sky-400">
      </select>

      <!-- CUT WINGS MODE -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5 mt-1">
        <span class="field-label-main" data-i18n="cutWingsLabel">Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Øµ Ù…Ù† Ø§Ù„Ø²Ø§ÙˆÙŠØ©</span>
        <span class="field-label-sub text-slate-400" data-i18n="cutWingsHint">Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ</span>
      </label>
      <div class="col-span-2 flex flex-wrap gap-3 text-xs text-slate-200">
        <label class="inline-flex items-center gap-1">
          <input type="radio" name="cutWings" value="top" checked class="text-sky-400 focus:ring-sky-500">
          <span data-i18n="cutModeTop">Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙÙ‚Ø·</span>
        </label>
        <label class="inline-flex items-center gap-1">
          <input type="radio" name="cutWings" value="bottom" class="text-sky-400 focus:ring-sky-500">
          <span data-i18n="cutModeBottom">Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ ÙÙ‚Ø·</span>
        </label>
        <label class="inline-flex items-center gap-1">
          <input type="radio" name="cutWings" value="both" class="text-sky-400 focus:ring-sky-500">
          <span data-i18n="cutModeBoth">Ù‚Øµ Ù…Ø³ØªÙ‚Ù„ (Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ)</span>
        </label>
      </div>

      <!-- ANGLE INPUT -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5 mt-1">
        <span class="field-label-main" data-i18n="angleLabel">Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ø¨ÙŠÙ† Ù‚Ø·Ø¹ØªÙŠÙ† Î¸ (Ø¯Ø±Ø¬Ø©)</span>
        <span class="field-label-sub text-slate-400" data-i18n="angleHint">ØªÙØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ø­Ø³Ø§Ø¨ Ù‚ÙŠÙ…Ø© Ù‚Øµ Ù…Ù‚ØªØ±Ø­Ø© â€” ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Øµ ÙŠØ¯ÙˆÙŠØ§Ù‹</span>
      </label>
      <div class="col-span-2 flex items-center gap-3">
        <input id="angleRange" type="range" min="1" max="45" step="0.5" value="30"/>
        <div class="flex items-center gap-1 text-xs text-slate-200">
          <input id="angle" type="number" min="1" max="45" step="0.5" value="30"
                 class="w-16 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 focus:outline-none focus:ring-1 focus:ring-sky-400 text-center"/>
          <span>Â°</span>
        </div>
      </div>

      <!-- CUT VALUES -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5 mt-1">
        <span class="field-label-main" data-i18n="deltaSectionLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ (Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ¬Ù…ÙŠØ¹) mm</span>
        <span class="field-label-sub text-slate-400" data-i18n="deltaSectionHint">
          ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚Øµ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„ÙƒÙ„ Ù…Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ â€” Ø§Ù„Ø²Ø§ÙˆÙŠØ© ØªØ­Ø³Ø¨ Ù…Ù† Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ†Ù‡Ù…Ø§.
        </span>
      </label>
      <div class="col-span-2 grid grid-cols-2 gap-3">
        <div>
          <div class="text-xs text-slate-400 mb-1" data-i18n="deltaTopLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Î”top</div>
          <div class="flex items-center gap-2 mb-1">
            <input id="deltaTop" type="number" min="0" step="0.1" value="0"
                   class="w-24 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 focus:outline-none focus:ring-1 focus:ring-emerald-400 text-xs text-center"/>
            <span class="text-[10px] text-slate-400">mm</span>
          </div>
          <input id="deltaTopRange" type="range" min="0" max="200" step="0.5" value="0"/>
        </div>
        <div>
          <div class="text-xs text-slate-400 mb-1" data-i18n="deltaBottomLabel">Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Î”bottom</div>
          <div class="flex items-center gap-2 mb-1">
            <input id="deltaBottom" type="number" min="0" step="0.1" value="0"
                   class="w-24 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 focus:outline-none focus:ring-1 focus:ring-emerald-400 text-xs text-center"/>
            <span class="text-[10px] text-slate-400">mm</span>
          </div>
          <input id="deltaBottomRange" type="range" min="0" max="200" step="0.5" value="0"/>
        </div>
      </div>

      <!-- VISUAL SLOPE -->
      <label class="col-span-2 text-slate-300 flex items-center justify-between mt-3">
        <span class="field-label-main" data-i18n="slopeSectionLabel">Ù…ÙŠÙ„Ø§Ù† Ø®Ø· Ø§Ù„Ù‚Øµ ÙÙŠ Ø§Ù„Ø±Ø³Ù… (Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ)</span>
        <span class="field-label-sub text-amber-300 text-[10px]" data-i18n="slopeSectionHint">ØªÙ…Ø«ÙŠÙ„ Ø¨ØµØ±ÙŠ ÙÙ‚Ø· â€” Ù„Ø§ ÙŠØºÙŠÙ‘Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</span>
      </label>

      <div class="col-span-2 grid grid-cols-2 gap-3">
        <div>
          <div class="text-xs text-slate-400 mb-1" data-i18n="alphaTopTitle">Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ Î±top</div>
          <div class="flex items-center gap-2">
            <input id="alphaTopRange" type="range" min="0" max="60" step="1" value="0"/>
            <div class="flex items-center gap-1 text-xs text-slate-200">
              <input id="alphaTop" type="number" min="0" max="60" step="1" value="0"
                     class="w-14 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center focus:outline-none focus:ring-1 focus:ring-sky-400"/>
              <span>Â°</span>
            </div>
          </div>
        </div>
        <div>
          <div class="text-xs text-slate-400 mb-1" data-i18n="alphaBottomTitle">Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ Î±bottom</div>
          <div class="flex items-center gap-2">
            <input id="alphaBottomRange" type="range" min="0" max="60" step="1" value="0"/>
            <div class="flex items-center gap-1 text-xs text-slate-200">
              <input id="alphaBottom" type="number" min="0" max="60" step="1" value="0"
                     class="w-14 rounded-lg border border-slate-700 bg-slate-900/80 px-2 py-1 text-center focus:outline-none focus:ring-1 focus:ring-sky-400"/>
              <span>Â°</span>
            </div>
          </div>
        </div>
      </div>

      <!-- TILT DIR -->
      <label class="col-span-2 text-slate-300 flex flex-col gap-0.5 mt-2">
        <span class="field-label-main" data-i18n="tiltDirSectionLabel">Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· (Ø±Ø³Ù… ÙÙ‚Ø·)</span>
        <span class="field-label-sub text-slate-400" data-i18n="tiltDirSectionHint">Ù†Ø­Ùˆ Ø§Ù„Ø¯Ø§Ø®Ù„ Ø£Ùˆ Ø§Ù„Ø®Ø§Ø±Ø¬ â€” Ø¨Ù„Ø§ ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨</span>
      </label>
      <div class="col-span-2 grid grid-cols-2 gap-3 text-xs text-slate-200">
        <div>
          <div class="mb-1 text-slate-400" data-i18n="tiltTopLabel">Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ</div>
          <div class="flex gap-2">
            <label class="inline-flex items-center gap-1">
              <input type="radio" name="tiltDirTop" value="in" checked class="text-sky-400 focus:ring-sky-500">
              <span data-i18n="tiltIn">Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·</span>
            </label>
            <label class="inline-flex items-center gap-1">
              <input type="radio" name="tiltDirTop" value="out" class="text-sky-400 focus:ring-sky-500">
              <span data-i18n="tiltOut">Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø±Ø¬</span>
            </label>
          </div>
        </div>
        <div>
          <div class="mb-1 text-slate-400" data-i18n="tiltBottomLabel">Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ</div>
          <div class="flex gap-2">
            <label class="inline-flex items-center gap-1">
              <input type="radio" name="tiltDirBottom" value="in" checked class="text-emerald-400 focus:ring-emerald-500">
              <span data-i18n="tiltIn">Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·</span>
            </label>
            <label class="inline-flex items-center gap-1">
              <input type="radio" name="tiltDirBottom" value="out" class="text-emerald-400 focus:ring-emerald-500">
              <span data-i18n="tiltOut">Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø±Ø¬</span>
            </label>
          </div>
        </div>
      </div>

    </div>

    <!-- READOUT -->
    <div id="readout" class="mt-5 rounded-xl border border-slate-700/80 bg-slate-900/70 px-3.5 py-3 text-sm"></div>

    <!-- BUTTONS -->
    <div class="mt-4 flex flex-wrap gap-2">
      <button id="btnReset"
              class="px-4 py-2 rounded-lg bg-slate-800 hover:bg-slate-700 text-xs sm:text-sm border border-slate-600"
              data-i18n="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·</button>
    </div>

    <p id="theoryText" class="text-[11px] text-slate-400 mt-3 leading-relaxed"></p>
  </section>

  <!-- PREVIEW PANEL -->
  <section class="glass rounded-2xl shadow-xl shadow-sky-950/50 border border-slate-700/70 p-4 sm:p-5 flex flex-col">
    <div class="flex items-center justify-between gap-2 mb-4">
      <div class="flex items-center gap-2">
        <span class="inline-flex h-6 w-6 rounded-full bg-emerald-500/20 border border-emerald-400/60 items-center justify-center text-[11px]">2</span>
        <h2 class="font-semibold text-lg sm:text-xl" data-i18n="panel2Title">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© â€” Ù‚Ø·Ø¹Ø© / Ù‚Ø·Ø¹ØªØ§Ù†</h2>
      </div>

      <!-- TABS -->
      <div class="bg-slate-900/70 border border-slate-700/80 rounded-full px-1 py-0.5 flex items-center gap-1 text-[11px]">
        <button id="tabSingle" class="tab-btn tab-btn-active" data-view="single">
          <span>â‘ </span><span data-i18n="tabSingle">Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</span>
        </button>
        <button id="tabJoint" class="tab-btn" data-view="joint">
          <span>â‘¡</span><span data-i18n="tabJoint">Ø¬Ù…Ø¹ Ù‚Ø·Ø¹ØªÙŠÙ†</span>
        </button>
      </div>
    </div>

    <!-- SINGLE PIECE VIEW -->
    <div id="viewSingle" class="flex-1 flex flex-col">
      <div class="flex-1 border border-slate-700/70 rounded-2xl bg-slate-900/70 px-3 py-4 flex items-center justify-center">
        <div id="frontWrapper" class="w-full max-w-[360px] mx-auto"></div>
      </div>
      <div class="grid grid-cols-2 gap-3 text-[11px] text-slate-400 mt-4">
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-slate-400/80"></span>
          <span data-i18n="legendFlanges">Ø§Ù„Ø¬Ù†Ø§Ø­Ø§Ù† (Ø¹Ù„ÙˆÙŠ / Ø³ÙÙ„ÙŠ)</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-slate-300"></span>
          <span data-i18n="legendWeb">Ø§Ù„Ø¹Ù…ÙˆØ¯ (web)</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-sm bg-red-500"></span>
          <span data-i18n="legendCuts">Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ = Ø§ØªØ¬Ø§Ù‡ ÙˆÙ…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‚Øµ ÙÙŠ Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block h-3 w-3 rounded-full border border-sky-400"></span>
          <span data-i18n="legendNote">Ø§Ù„Ø±Ø³Ù… ØªÙ…Ø«ÙŠÙ„ÙŠ â€” Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ù‡ÙŠ Ø§Ù„Ù…Ø±Ø¬Ø¹</span>
        </div>
      </div>
    </div>

    <!-- JOINT VIEW -->
    <div id="viewJoint" class="flex-1 flex flex-col view-hidden">
      <div class="flex-1 border border-slate-700/70 rounded-2xl bg-slate-900/70 px-3 py-4 flex items-center justify-center">
        <div id="jointWrapper" class="w-full max-w-[420px] mx-auto"></div>
      </div>
      <p class="text-[11px] text-slate-400 mt-3" data-i18n="jointHint">
        ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø³Ù… ØªØ¸Ù‡Ø± Ù‚Ø·Ø¹ØªØ§Ù† Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ â€” Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ù…Ù‚ØµÙˆØµØ© ÙØ¹Ù„Ø§Ù‹ Ø­Ø³Ø¨ Î”top Ùˆ Î”bottomØŒ Ù…Ø¹ ÙØ±Ø§Øº ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…Ø§Ø³
        (â‰ˆ 0.003) ÙˆØ²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ.
      </p>
    </div>

  </section>
</main>

<footer class="max-w-6xl mx-auto px-4 pb-6 text-[11px] text-slate-500 flex flex-wrap items-center justify-between gap-2">
  <span data-i18n="footerLeft">HE Cut Pro v21 â€” ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ÙŠÙ†</span>
  <span data-i18n="footerRight">Ù„Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠ: Ø§Ø¹ØªÙ…Ø¯ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ ÙˆØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø© ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…Ø©.</span>
</footer>

<!-- I18N -->
<script>
  const I18N = {
    ar: {
      appTitle: "HE Cut Pro",
      subtitle: "Ù‚Øµ Ø£Ø¬Ù†Ø­Ø© HEA / HEB / HEM â€” Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© + Ø¬Ù…Ø¹ Ù‚Ø·Ø¹ØªÙŠÙ† Ù…Ù† Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©",
      panel1Title: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª & Ø§Ù„Ø­Ø³Ø§Ø¨",
      panel2Title: "Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© â€” Ù‚Ø·Ø¹Ø© / Ù‚Ø·Ø¹ØªØ§Ù†",
      seriesLabel: "Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ù‚Ø·Ø¹",
      seriesHint: "HEA / HEB / HEM",
      sizeLabel: "Ø§Ù„Ù…Ù‚Ø§Ø³",
      sizeHint: "HE 100 â€¦ HE 400 (ØªÙ‚Ø±ÙŠØ¨ÙŠ)",
      cutWingsLabel: "Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Øµ Ù…Ù† Ø§Ù„Ø²Ø§ÙˆÙŠØ©",
      cutWingsHint: "Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ",
      cutModeTop: "Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙÙ‚Ø·",
      cutModeBottom: "Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ ÙÙ‚Ø·",
      cutModeBoth: "Ù‚Øµ Ù…Ø³ØªÙ‚Ù„ (Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ)",
      angleLabel: "Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ø¨ÙŠÙ† Ù‚Ø·Ø¹ØªÙŠÙ† Î¸ (Ø¯Ø±Ø¬Ø©)",
      angleHint: "ØªÙØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ø­Ø³Ø§Ø¨ Ù‚ÙŠÙ…Ø© Ù‚Øµ Ù…Ù‚ØªØ±Ø­Ø© â€” ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Øµ ÙŠØ¯ÙˆÙŠØ§Ù‹",
      deltaSectionLabel: "Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ (Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ¬Ù…ÙŠØ¹) mm",
      deltaSectionHint: "ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚Øµ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„ÙƒÙ„ Ù…Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙˆØ§Ù„Ø³ÙÙ„ÙŠ â€” Ø§Ù„Ø²Ø§ÙˆÙŠØ© ØªØ­Ø³Ø¨ Ù…Ù† Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ†Ù‡Ù…Ø§.",
      deltaTopLabel: "Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Î”top",
      deltaBottomLabel: "Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Î”bottom",
      slopeSectionLabel: "Ù…ÙŠÙ„Ø§Ù† Ø®Ø· Ø§Ù„Ù‚Øµ ÙÙŠ Ø§Ù„Ø±Ø³Ù… (Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ)",
      slopeSectionHint: "ØªÙ…Ø«ÙŠÙ„ Ø¨ØµØ±ÙŠ ÙÙ‚Ø· â€” Ù„Ø§ ÙŠØºÙŠÙ‘Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ",
      alphaTopTitle: "Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ Î±top",
      alphaBottomTitle: "Ø²Ø§ÙˆÙŠØ© Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ Î±bottom",
      tiltDirSectionLabel: "Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· (Ø±Ø³Ù… ÙÙ‚Ø·)",
      tiltDirSectionHint: "Ù†Ø­Ùˆ Ø§Ù„Ø¯Ø§Ø®Ù„ Ø£Ùˆ Ø§Ù„Ø®Ø§Ø±Ø¬ â€” Ø¨Ù„Ø§ ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨",
      tiltTopLabel: "Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ù„ÙˆÙŠ",
      tiltBottomLabel: "Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· Ø§Ù„Ø³ÙÙ„ÙŠ",
      tiltIn: "Ù†Ø­Ùˆ Ø§Ù„ÙˆØ³Ø·",
      tiltOut: "Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø±Ø¬",
      resetBtn: "Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·",
      legendFlanges: "Ø§Ù„Ø¬Ù†Ø§Ø­Ø§Ù† (Ø¹Ù„ÙˆÙŠ / Ø³ÙÙ„ÙŠ)",
      legendWeb: "Ø§Ù„Ø¹Ù…ÙˆØ¯ (web)",
      legendCuts: "Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ = Ø§ØªØ¬Ø§Ù‡ ÙˆÙ…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‚Øµ ÙÙŠ Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©",
      legendNote: "Ø§Ù„Ø±Ø³Ù… ØªÙ…Ø«ÙŠÙ„ÙŠ â€” Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ù‡ÙŠ Ø§Ù„Ù…Ø±Ø¬Ø¹",
      footerLeft: "HE Cut Pro v21 â€” ÙØ±Ù‚ Ø§Ù„Ù‚Øµ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù†Ø§Ø­ÙŠÙ†",
      footerRight: "Ù„Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠ: Ø§Ø¹ØªÙ…Ø¯ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ ÙˆØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø© ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„Ø§Ù…Ø©.",
      tabSingle: "Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©",
      tabJoint: "Ø¬Ù…Ø¹ Ù‚Ø·Ø¹ØªÙŠÙ†",
      jointHint: "ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø³Ù… ØªØ¸Ù‡Ø± Ù‚Ø·Ø¹ØªØ§Ù† Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ â€” Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ù…Ù‚ØµÙˆØµØ© ÙØ¹Ù„Ø§Ù‹ Ø­Ø³Ø¨ Î”top Ùˆ Î”bottomØŒ Ù…Ø¹ ÙØ±Ø§Øº ØµØºÙŠØ± Ø¬Ø¯Ø§Ù‹ Ø¹Ù†Ø¯ Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ…Ø§Ø³ (â‰ˆ 0.003) ÙˆØ²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ.",
      summaryTitle: "Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨",
      profileLabel: "Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„",
      flangeWidthLabel: "Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ù†Ø§Ø­ b (ØªÙ‚Ø±ÙŠØ¨ÙŠ)",
      cutModeDescTop: "Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ ÙÙ‚Ø·",
      cutModeDescBottom: "Ù‚Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ ÙÙ‚Ø·",
      cutModeDescBoth: "Ù‚Øµ Ù…Ø³ØªÙ‚Ù„ Ù„Ù„Ø¬Ù†Ø§Ø­ÙŠÙ† (Ø²Ø§ÙˆÙŠØ© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ)",
      targetAngleLabel: "Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù‡Ø¯Ù (Ù…Ù† Ø§Ù„Ø´Ø±ÙŠØ·)",
      deltaTopLabelTable: "Î”top â€” Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø©",
      deltaBottomLabelTable: "Î”bottom â€” Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Ù„ÙƒÙ„ Ù‚Ø·Ø¹Ø©",
      diffCutLabel: "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ù‚ØµÙŠÙ† |Î”top âˆ’ Î”bottom|",
      pairAngleLabel: "Ø²Ø§ÙˆÙŠØ© ØªØ¬Ù…ÙŠØ¹ ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ù†Ø§ØªØ¬Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ",
      pairAngleZeroNote: "â‰ˆ 0Â° (Î”top = Î”bottom ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ â€” Ø§Ù„Ù‚Ø·Ø¹ØªØ§Ù† ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ø³ØªÙ‚Ø§Ù…Ø© ÙˆØ§Ø­Ø¯Ø©)",
      remainingTopLabel: "Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ",
      remainingBottomLabel: "Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø³ÙÙ„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Øµ",
      alphaTopLabelTable: "Î±top ÙÙŠ Ø§Ù„Ø±Ø³Ù…",
      alphaBottomLabelTable: "Î±bottom ÙÙŠ Ø§Ù„Ø±Ø³Ù…",
      tiltTopDirLabel: "Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ø±Ø³Ù…)",
      tiltBottomDirLabel: "Ø§ØªØ¬Ø§Ù‡ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø³ÙÙ„ÙŠ (Ø±Ø³Ù…)",
      noteDiffZero: "Ø¥Ø°Ø§ ÙƒØ§Ù† Î”top = Î”bottom Ø¨Ø§Ù„Ø¶Ø¨Ø· â‡’ Ø§Ù„ÙØ±Ù‚ = 0 â‡’ Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù†Ø§ØªØ¬Ø© Ù…Ù† Ø§Ù„Ù‚Øµ â‰ˆ 0Â° Ø­ØªÙ‰ Ù„Ùˆ Ø§Ø®ØªØ±Øª Ø²Ø§ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ·.",
      jointAngleLabel: "Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ:",
      jointGapLabel: "ÙØ±Ø§Øº Ù†Ø¸Ø±ÙŠ ØµØºÙŠØ± Ø¹Ù†Ø¯ Ù†Ù‚Ø·Ø© Ø§Ù„ØªÙ…Ø§Ø³ (â‰ˆ 0.003)."
    },
    en: {
      appTitle: "HE Cut Pro",
      subtitle: "HEA / HEB / HEM flange cutting â€” single piece + two-piece joint front view",
      panel1Title: "Settings & Calculation",
      panel2Title: "Front Preview â€” Single / Joint",
      seriesLabel: "Section Series",
      seriesHint: "HEA / HEB / HEM",
      sizeLabel: "Size",
      sizeHint: "HE 100 â€¦ HE 400 (approx.)",
      cutWingsLabel: "Flanges used in angle-based cut calculation",
      cutWingsHint: "Assembly angle depends on cut difference between top and bottom",
      cutModeTop: "Cut on top flange only",
      cutModeBottom: "Cut on bottom flange only",
      cutModeBoth: "Independent cuts (manual input)",
      angleLabel: "Target assembly angle between two pieces Î¸ (deg)",
      angleHint: "Used only to propose a cut value â€” you can override by manual cuts.",
      deltaSectionLabel: "Flange cut (per piece before assembly) mm",
      deltaSectionHint: "You can enter cuts manually for top and bottom â€” angle is derived from the difference.",
      deltaTopLabel: "Top flange cut Î”top",
      deltaBottomLabel: "Bottom flange cut Î”bottom",
      slopeSectionLabel: "Cut line tilt in drawing (from vertical)",
      slopeSectionHint: "Visual only â€” does not change geometry",
      alphaTopTitle: "Top cut line tilt angle Î±top",
      alphaBottomTitle: "Bottom cut line tilt angle Î±bottom",
      tiltDirSectionLabel: "Tilt direction (drawing only)",
      tiltDirSectionHint: "Inwards or outwards â€” no effect on math",
      tiltTopLabel: "Top tilt direction",
      tiltBottomLabel: "Bottom tilt direction",
      tiltIn: "Towards center",
      tiltOut: "Outwards",
      resetBtn: "Reset",
      legendFlanges: "Flanges (top / bottom)",
      legendWeb: "Web",
      legendCuts: "Red lines = cut position & tilt for a single piece",
      legendNote: "Drawing is representative â€” numeric dimensions are the reference",
      footerLeft: "HE Cut Pro v21 â€” Flange cut difference",
      footerRight: "For fabrication: refer to section catalog, workshop procedures, and safety rules.",
      tabSingle: "Single Piece",
      tabJoint: "Two-Piece Joint",
      jointHint: "Here you see two pieces from the front after cutting â€” flanges are actually shortened according to Î”top and Î”bottom, with a tiny gap at the contact points (â‰ˆ 0.003) and an assembly angle derived from the cut difference.",
      summaryTitle: "Calculation Summary",
      profileLabel: "Profile",
      flangeWidthLabel: "Flange width b (approx.)",
      cutModeDescTop: "Cut on top flange only",
      cutModeDescBottom: "Cut on bottom flange only",
      cutModeDescBoth: "Independent cuts (angle from difference)",
      targetAngleLabel: "Target assembly angle (from slider)",
      deltaTopLabelTable: "Î”top â€” top flange cut per piece",
      deltaBottomLabelTable: "Î”bottom â€” bottom flange cut per piece",
      diffCutLabel: "Cut difference |Î”top âˆ’ Î”bottom|",
      pairAngleLabel: "Approx. assembly angle from cut difference",
      pairAngleZeroNote: "â‰ˆ 0Â° (Î”top = Î”bottom â€” pieces nearly straight)",
      remainingTopLabel: "Remaining top flange width after cut",
      remainingBottomLabel: "Remaining bottom flange width after cut",
      alphaTopLabelTable: "Î±top in drawing",
      alphaBottomLabelTable: "Î±bottom in drawing",
      tiltTopDirLabel: "Top tilt direction (drawing)",
      tiltBottomDirLabel: "Bottom tilt direction (drawing)",
      noteDiffZero: "If Î”top = Î”bottom exactly â‡’ diff = 0 â‡’ resulting angle from cuts â‰ˆ 0Â° even if you set a slider angle.",
      jointAngleLabel: "Assembly angle derived from cut difference:",
      jointGapLabel: "Small theoretical gap at contact point (â‰ˆ 0.003)."
    },
    de: {
      appTitle: "HE Cut Pro",
      subtitle: "HEA / HEB / HEM Flanschschnitte â€” Einzelteil + Zwei-Teil-Fuge in Vorderansicht",
      panel1Title: "Einstellungen & Berechnung",
      panel2Title: "Vorderansicht â€” Einzelteil / Fuge",
      seriesLabel: "Profilserie",
      seriesHint: "HEA / HEB / HEM",
      sizeLabel: "GrÃ¶ÃŸe",
      sizeHint: "HE 100 â€¦ HE 400 (ca.)",
      cutWingsLabel: "Flansche fÃ¼r winkelbasierte Schnittberechnung",
      cutWingsHint: "Montagewinkel hÃ¤ngt von der Schnittdifferenz zwischen oben und unten ab",
      cutModeTop: "Nur am oberen Flansch schneiden",
      cutModeBottom: "Nur am unteren Flansch schneiden",
      cutModeBoth: "UnabhÃ¤ngige Schnitte (manuelle Eingabe)",
      angleLabel: "Zielmontagewinkel zwischen zwei Teilen Î¸ (Grad)",
      angleHint: "Nur zur Vorschlag eines Schnittwertes â€” manuelle Schnitte sind mÃ¶glich.",
      deltaSectionLabel: "Flanschschnitt (pro Teil vor Montage) mm",
      deltaSectionHint: "Sie kÃ¶nnen Schnitte fÃ¼r oben und unten manuell eingeben â€” der Winkel wird aus der Differenz berechnet.",
      deltaTopLabel: "Oberer Flanschschnitt Î”top",
      deltaBottomLabel: "Unterer Flanschschnitt Î”bottom",
      slopeSectionLabel: "Schnittlinienneigung in Zeichnung (von vertikal)",
      slopeSectionHint: "Nur visuell â€” keine Ã„nderung der Geometrie",
      alphaTopTitle: "Neigungswinkel der oberen Schnittlinie Î±top",
      alphaBottomTitle: "Neigungswinkel der unteren Schnittlinie Î±bottom",
      tiltDirSectionLabel: "Neigungsrichtung (nur Zeichnung)",
      tiltDirSectionHint: "Zur Mitte oder nach auÃŸen â€” ohne Einfluss auf Berechnungen",
      tiltTopLabel: "Neigungsrichtung oben",
      tiltBottomLabel: "Neigungsrichtung unten",
      tiltIn: "Zur Mitte",
      tiltOut: "Nach auÃŸen",
      resetBtn: "ZurÃ¼cksetzen",
      legendFlanges: "Flansche (oben / unten)",
      legendWeb: "Steg",
      legendCuts: "Rote Linien = Schnittlage und -neigung fÃ¼r ein Einzelteil",
      legendNote: "Zeichnung ist reprÃ¤sentativ â€” numerische MaÃŸe sind maÃŸgebend",
      footerLeft: "HE Cut Pro v21 â€” Flanschschnittdifferenz",
      footerRight: "FÃ¼r die AusfÃ¼hrung: Profilkatalog, Werkstattanweisungen und Sicherheitsregeln beachten.",
      tabSingle: "Einzelteil",
      tabJoint: "Zwei-Teil-Fuge",
      jointHint: "Hier sehen Sie zwei Teile in Vorderansicht nach dem Schneiden â€” Flansche sind gemÃ¤ÃŸ Î”top und Î”bottom tatsÃ¤chlich verkÃ¼rzt, mit einem sehr kleinen Spalt an den Kontaktpunkten (â‰ˆ 0,003) und einem Montagewinkel aus der Schnittdifferenz.",
      summaryTitle: "BerechnungsÃ¼bersicht",
      profileLabel: "Profil",
      flangeWidthLabel: "Flanschbreite b (ca.)",
      cutModeDescTop: "Schnitt nur am oberen Flansch",
      cutModeDescBottom: "Schnitt nur am unteren Flansch",
      cutModeDescBoth: "UnabhÃ¤ngige Flanschschnitte (Winkel aus Differenz)",
      targetAngleLabel: "Zielmontagewinkel (aus Schieber)",
      deltaTopLabelTable: "Î”top â€” oberer Flanschschnitt pro Teil",
      deltaBottomLabelTable: "Î”bottom â€” unterer Flanschschnitt pro Teil",
      diffCutLabel: "Schnittdifferenz |Î”top âˆ’ Î”bottom|",
      pairAngleLabel: "UngefÃ¤hrer Montagewinkel aus Schnittdifferenz",
      pairAngleZeroNote: "â‰ˆ 0Â° (Î”top = Î”bottom â€” Teile nahezu gerade)",
      remainingTopLabel: "Verbleibende Breite oben nach Schnitt",
      remainingBottomLabel: "Verbleibende Breite unten nach Schnitt",
      alphaTopLabelTable: "Î±top in Zeichnung",
      alphaBottomLabelTable: "Î±bottom in Zeichnung",
      tiltTopDirLabel: "Neigungsrichtung oben (Zeichnung)",
      tiltBottomDirLabel: "Neigungsrichtung unten (Zeichnung)",
      noteDiffZero: "Wenn Î”top = Î”bottom genau â‡’ Differenz = 0 â‡’ resultierender Winkel aus Schnitten â‰ˆ 0Â°, auch wenn im Schieber ein Winkel gewÃ¤hlt wird.",
      jointAngleLabel: "Montagewinkel aus Schnittdifferenz:",
      jointGapLabel: "Kleiner theoretischer Spalt am Kontaktpunkt (â‰ˆ 0,003)."
    }
  };
</script>

<!-- LOGIC -->
<script>
  // ØªÙ‚Ø±ÙŠØ¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¬Ù†Ø­Ø© b
  const HE_DATA = {
    HEA:{100:{b:100},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:280},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}},
    HEB:{100:{b:100},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:280},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}},
    HEM:{100:{b:120},120:{b:120},140:{b:140},160:{b:160},180:{b:180},200:{b:200},220:{b:220},240:{b:240},260:{b:260},280:{b:260},300:{b:300},320:{b:300},340:{b:300},360:{b:300},400:{b:300}}
  };

  const CALIB = 1.0339; // Ù…Ø¹Ø§ÙŠØ±Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„ÙˆØ§Ù‚Ø¹
  const GAP_DEG = 0.03; // ÙØ±Ø§Øº Ù†Ø¸Ø±ÙŠ ØµØºÙŠØ± ÙÙŠ Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹

  // Ø¹Ù†Ø§ØµØ± DOM
  const $series = document.getElementById('series');
  const $size = document.getElementById('size');
  const $angle = document.getElementById('angle');
  const $angleRange = document.getElementById('angleRange');
  const $deltaTop = document.getElementById('deltaTop');
  const $deltaBottom = document.getElementById('deltaBottom');
  const $deltaTopRange = document.getElementById('deltaTopRange');
  const $deltaBottomRange = document.getElementById('deltaBottomRange');
  const $alphaTop = document.getElementById('alphaTop');
  const $alphaTopRange = document.getElementById('alphaTopRange');
  const $alphaBottom = document.getElementById('alphaBottom');
  const $alphaBottomRange = document.getElementById('alphaBottomRange');
  const $readout = document.getElementById('readout');
  const $frontWrapper = document.getElementById('frontWrapper');
  const $jointWrapper = document.getElementById('jointWrapper');
  const $btnReset = document.getElementById('btnReset');
  const $themeToggle = document.getElementById('themeToggle');
  const $tabSingle = document.getElementById('tabSingle');
  const $tabJoint = document.getElementById('tabJoint');
  const $viewSingle = document.getElementById('viewSingle');
  const $viewJoint = document.getElementById('viewJoint');
  const $theoryText = document.getElementById('theoryText');

  const $langButtons = document.querySelectorAll('.lang-btn');
  const $cutWingsRadios = document.querySelectorAll('input[name="cutWings"]');

  let currentLang = 'ar';
  let mode = 'angle'; // 'angle' Ø£Ùˆ 'cuts'

  // Ù…ØªØºÙŠØ±Ø§Øª ØªÙØ§Ø¹Ù„ Ø§Ù„Ù‚Ø·Ø¹ (Ø¯ÙˆØ±Ø§Ù† + ØªØ­Ø±ÙŠÙƒ)
  let userTiltLeft = 0;
  let userTiltRight = 0;
  let userShiftLeft = 0;
  let userShiftRight = 0;

  const MAX_DRAG_SHIFT = 40;
  const MAX_DRAG_TILT = 20;
  const DRAG_ROT_FACTOR = 0.25;

  let activePiece = null;
  let dragStartX = 0;
  let dragStartY = 0;
  let dragStartShift = 0;
  let dragStartTilt = 0;

  function getCutMode(){
    const c = document.querySelector('input[name="cutWings"]:checked');
    return c ? c.value : 'top';
  }
  function getTiltDirTop(){
    const c = document.querySelector('input[name="tiltDirTop"]:checked');
    return c ? c.value : 'in';
  }
  function getTiltDirBottom(){
    const c = document.querySelector('input[name="tiltDirBottom"]:checked');
    return c ? c.value : 'in';
  }

  function populateSizes(){
    const s = $series.value;
    const sizes = Object.keys(HE_DATA[s]).map(Number).sort((a,b)=>a-b);
    $size.innerHTML = sizes.map(v=>`<option value="${v}" ${v===180?'selected':''}>${v}</option>`).join('');
  }

  // Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ù…Ù† ÙØ±Ù‚ Ø§Ù„Ù‚Øµ
  function angleFromCuts(dt,db,b){
    if(b<=0) return 0;
    const diff = Math.abs(dt-db);
    if(diff<0.0001) return 0;
    const halfRad = Math.atan(diff/(b*CALIB));
    return 2*halfRad*180/Math.PI;
  }

  function applyTranslations(lang){
    currentLang = lang;
    const dict = I18N[lang] || I18N.ar;
    document.documentElement.lang = lang;
    document.documentElement.dir = (lang==='ar')?'rtl':'ltr';

    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      if(dict[key]) el.innerHTML = dict[key];
    });
    $langButtons.forEach(btn=>{
      btn.classList.toggle('lang-btn-active', btn.dataset.lang===lang);
    });

    if(lang==='ar'){
      $theoryText.innerHTML =
        "â€¢ Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠÙ† Ù‚Ø·Ø¹ØªÙŠÙ† Ù„Ø§ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Øµ Ù†ÙØ³Ù‡Ø§ØŒ Ø¨Ù„ Ø¹Ù„Ù‰ <b>Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ù‚Øµ Ø§Ù„Ø¬Ù†Ø§Ø­ Ø§Ù„Ø¹Ù„ÙˆÙŠ Î”top ÙˆØ§Ù„Ø³ÙÙ„ÙŠ Î”bottom</b>.<br>" +
        "â€¢ Ø¥Ø°Ø§ ÙƒØ§Ù† Î”top = Î”bottom â‡’ Ø§Ù„ÙØ±Ù‚ = 0 â‡’ Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù†Ø§ØªØ¬Ø© Ù…Ù† Ø§Ù„Ù‚Øµ â‰ˆ 0Â° (Ø§Ù„Ù‚Ø·Ø¹ØªØ§Ù† ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ø³ØªÙ‚Ø§Ù…Ø© ÙˆØ§Ø­Ø¯Ø©).<br>" +
        "â€¢ ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯ |Î”top âˆ’ Î”bottom| Ø²Ø§Ø¯Øª Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø©.<br>" +
        "â€¢ Ø²Ø§ÙˆÙŠØªØ§ Ù…ÙŠÙ„Ø§Ù† Ø§Ù„Ø®Ø· (Î±top, Î±bottom) ÙˆØ§ØªØ¬Ø§Ù‡ Ø§Ù„Ù…ÙŠÙ„Ø§Ù† ØªØ¤Ø«Ø± ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ø§Ù„Ø®Ø· ÙÙŠ Ø§Ù„Ø±Ø³Ù… ÙˆÙ„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª.";
    } else if(lang==='en'){
      $theoryText.innerHTML =
        "â€¢ The assembly angle between two pieces does not depend on the absolute cut value, but on the <b>difference between top cut Î”top and bottom cut Î”bottom</b>.<br>" +
        "â€¢ If Î”top = Î”bottom â‡’ difference = 0 â‡’ resulting angle from cuts â‰ˆ 0Â° (pieces nearly straight).<br>" +
        "â€¢ The larger |Î”top âˆ’ Î”bottom| is, the larger the computed assembly angle.<br>" +
        "â€¢ Tilt angles (Î±top, Î±bottom) and tilt direction affect only the line shape in the drawing and do not change calculations.";
    } else {
      $theoryText.innerHTML =
        "â€¢ Der Montagewinkel zwischen zwei Teilen hÃ¤ngt nicht vom absoluten Schnittwert ab, sondern von der <b>Differenz zwischen oberem Schnitt Î”top und unterem Schnitt Î”bottom</b>.<br>" +
        "â€¢ Wenn Î”top = Î”bottom â‡’ Differenz = 0 â‡’ resultierender Winkel aus Schnitten â‰ˆ 0Â° (Teile nahezu gerade).<br>" +
        "â€¢ Je grÃ¶ÃŸer |Î”top âˆ’ Î”bottom|, desto grÃ¶ÃŸer der berechnete Montagewinkel.<br>" +
        "â€¢ Neigungswinkel (Î±top, Î±bottom) und Richtung beeinflussen nur die Linienform in der Zeichnung und Ã¤ndern die Berechnung nicht.";
    }

    calc();
  }

  function buildState(){
    const s = $series.value;
    const sz = Number($size.value);
    const cutMode = getCutMode();
    const tiltDirTop = getTiltDirTop();
    const tiltDirBottom = getTiltDirBottom();
    const data = HE_DATA[s][sz] || {b:180};
    const b = data.b;

    const maxCut = Math.round(b*0.6);

    let angDeg = Number($angle.value);
    let dt = Number($deltaTop.value);
    let db = Number($deltaBottom.value);
    let alphaTopDeg = Number($alphaTop.value);
    let alphaBottomDeg = Number($alphaBottom.value);

    if(isNaN(dt)) dt=0;
    if(isNaN(db)) db=0;
    if(isNaN(alphaTopDeg)) alphaTopDeg=0;
    if(isNaN(alphaBottomDeg)) alphaBottomDeg=0;

    alphaTopDeg = Math.max(0,Math.min(60,alphaTopDeg));
    alphaBottomDeg = Math.max(0,Math.min(60,alphaBottomDeg));

    if(mode === 'angle'){
      if(!isFinite(angDeg) || angDeg<1) angDeg = 1;
      if(angDeg>45) angDeg = 45;
      const halfRad = (angDeg*Math.PI/180)/2;
      const deltaGeom = Math.min(maxCut, b*Math.tan(halfRad)*CALIB);
      if(cutMode==='top'){ dt = deltaGeom; db = 0; }
      else if(cutMode==='bottom'){ dt = 0; db = deltaGeom; }
      else { dt = deltaGeom; db = 0; }
    } else {
      dt = Math.max(0,Math.min(dt,maxCut));
      db = Math.max(0,Math.min(db,maxCut));
      angDeg = Math.min(45,Math.max(0,angleFromCuts(dt,db,b)));
    }

    $angle.value = angDeg.toFixed(1);
    $angleRange.value = angDeg;
    $deltaTop.value = dt.toFixed(1);
    $deltaBottom.value = db.toFixed(1);
    $deltaTopRange.value = dt;
    $deltaBottomRange.value = db;
    $alphaTop.value = alphaTopDeg.toFixed(0);
    $alphaTopRange.value = alphaTopDeg;
    $alphaBottom.value = alphaBottomDeg.toFixed(0);
    $alphaBottomRange.value = alphaBottomDeg;

    const pairAngleRaw = angleFromCuts(dt,db,b);
    const pairAngle = Math.max(0,pairAngleRaw - GAP_DEG);
    const remainingTop = Math.max(b-dt,0);
    const remainingBottom = Math.max(b-db,0);
    const diffCut = Math.abs(dt-db);

    return {
      s, sz, b,
      cutMode,
      tiltDirTop, tiltDirBottom,
      angDeg,
      dt, db,
      maxCut,
      alphaTopDeg, alphaBottomDeg,
      pairAngleRaw, pairAngle,
      remainingTop, remainingBottom,
      diffCut
    };
  }

  function renderReadout(state){
    const dict = I18N[currentLang] || I18N.ar;
    const {
      s, sz, b,
      cutMode,
      angDeg,
      dt, db,
      remainingTop, remainingBottom,
      alphaTopDeg, alphaBottomDeg,
      tiltDirTop, tiltDirBottom,
      pairAngle, diffCut
    } = state;

    const cutModeText =
      cutMode==='top' ? dict.cutModeDescTop :
      cutMode==='bottom' ? dict.cutModeDescBottom :
      dict.cutModeDescBoth;

    const pairAngleText = pairAngle===0
      ? dict.pairAngleZeroNote
      : `${pairAngle.toFixed(2)}Â°`;

    const tiltTopTxt = tiltDirTop==='in' ? dict.tiltIn : dict.tiltOut;
    const tiltBottomTxt = tiltDirBottom==='in' ? dict.tiltIn : dict.tiltOut;

    $readout.innerHTML = `
      <div class="text-sky-300 text-xs mb-1">${dict.summaryTitle}</div>
      <div class="grid grid-cols-2 gap-x-3 gap-y-1 text-xs">
        <div>${dict.profileLabel}:</div>
        <div class="text-right"><b>${s} ${sz}</b></div>

        <div>${dict.flangeWidthLabel}:</div>
        <div class="text-right"><b>${b.toFixed(0)} mm</b></div>

        <div>${dict.cutWingsLabel}:</div>
        <div class="text-right"><b>${cutModeText}</b></div>

        <div>${dict.targetAngleLabel}:</div>
        <div class="text-right text-sky-300"><b>${angDeg.toFixed(2)}Â°</b></div>

        <div>${dict.deltaTopLabelTable}:</div>
        <div class="text-right text-emerald-300"><b>${dt.toFixed(1)} mm</b></div>

        <div>${dict.deltaBottomLabelTable}:</div>
        <div class="text-right text-emerald-300"><b>${db.toFixed(1)} mm</b></div>

        <div>${dict.diffCutLabel}:</div>
        <div class="text-right text-amber-300"><b>${diffCut.toFixed(1)} mm</b></div>

        <div>${dict.pairAngleLabel}:</div>
        <div class="text-right text-sky-300"><b>${pairAngleText}</b></div>

        <div>${dict.remainingTopLabel}:</div>
        <div class="text-right"><b>${remainingTop.toFixed(1)} mm</b></div>

        <div>${dict.remainingBottomLabel}:</div>
        <div class="text-right"><b>${remainingBottom.toFixed(1)} mm</b></div>

        <div>${dict.alphaTopLabelTable}:</div>
        <div class="text-right"><b>${alphaTopDeg.toFixed(0)}Â°</b></div>

        <div>${dict.alphaBottomLabelTable}:</div>
        <div class="text-right"><b>${alphaBottomDeg.toFixed(0)}Â°</b></div>

        <div>${dict.tiltTopDirLabel}:</div>
        <div class="text-right"><b>${tiltTopTxt}</b></div>

        <div>${dict.tiltBottomDirLabel}:</div>
        <div class="text-right"><b>${tiltBottomTxt}</b></div>
      </div>
      <div class="text-[10px] text-slate-400 mt-2">
        ${dict.noteDiffZero}
      </div>
    `;
  }

  // Ù‚Ø·Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©
  function renderSingleFront(state){
    const {
      s, sz, b,
      angDeg,
      dt, db,
      alphaTopDeg, alphaBottomDeg,
      tiltDirTop, tiltDirBottom
    } = state;

    const w = 320, h = 260, pad = 30;
    const midX = w/2, topY = pad, botY = h-pad;
    const scale = Math.min(1.1,Math.max(0.7,sz/220));
    const profileH = 200*scale;
    const flangeTh = Math.max(18,profileH*0.18);
    const webTh = Math.max(12,profileH*0.12);
    const cy = (topY+botY)/2;
    const tfy = cy-profileH/2;
    const bfy = cy+profileH/2;
    const span = 70+(b-180)*0.25;
    const fl = midX-span;
    const fr = midX+span;
    const fw = fr-fl;

    const ft = b>0?dt/b:0;
    const fb = b>0?db/b:0;
    const cutXTop = fr-ft*fw;
    const cutXBottom = fr-fb*fw;

    const phiTopRad = alphaTopDeg*Math.PI/180;
    const phiBottomRad = alphaBottomDeg*Math.PI/180;
    const dirSignTop = tiltDirTop==='in' ? -1 : 1;
    const dirSignBottom = tiltDirBottom==='in' ? -1 : 1;
    const dxTop = Math.tan(phiTopRad)*flangeTh*dirSignTop;
    const dxBottom = Math.tan(phiBottomRad)*flangeTh*dirSignBottom;

    const showTopLine = dt>0.0001;
    const showBottomLine = db>0.0001;

    const angleText = `Î¸ â‰ˆ ${angDeg.toFixed(1)}Â°`;

    const svg = `
      <svg width="100%" height="${h}" viewBox="0 0 ${w} ${h}" preserveAspectRatio="xMidYMid meet">
        <defs>
          <linearGradient id="metalGrad" x1="0%" y1="0%" x2="100%">
            <stop offset="0%" stop-color="#cbd5f5"/>
            <stop offset="40%" stop-color="#e5e7eb"/>
            <stop offset="70%" stop-color="#9ca3af"/>
            <stop offset="100%" stop-color="#6b7280"/>
          </linearGradient>
          <linearGradient id="webGrad" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#e5e7eb"/>
            <stop offset="100%" stop-color="#9ca3af"/>
          </linearGradient>
          <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="6" stdDeviation="6"
                          flood-color="#020617" flood-opacity="0.8"/>
          </filter>
        </defs>

        <g filter="url(#shadow)">
          <rect x="${fl}" y="${tfy}"
                width="${fw}" height="${flangeTh}"
                fill="url(#metalGrad)" stroke="#94a3b8" stroke-width="1"/>
          <rect x="${fl}" y="${bfy-flangeTh}"
                width="${fw}" height="${flangeTh}"
                fill="url(#metalGrad)" stroke="#94a3b8" stroke-width="1"/>
          <rect x="${midX-webTh/2}" y="${tfy+flangeTh}"
                width="${webTh}"
                height="${profileH-2*flangeTh}"
                fill="url(#webGrad)" stroke="#94a3b8" stroke-width="1"/>
        </g>

        ${showTopLine ? `
          <line x1="${cutXTop}" y1="${tfy}"
                x2="${cutXTop+dxTop}" y2="${tfy+flangeTh}"
                stroke="#f97373" stroke-width="4" stroke-linecap="round"/>` : ''}

        ${showBottomLine ? `
          <line x1="${cutXBottom}" y1="${bfy-flangeTh}"
                x2="${cutXBottom+dxBottom}" y2="${bfy}"
                stroke="#f97373" stroke-width="4" stroke-linecap="round"/>` : ''}

        <text x="${midX}" y="${tfy-12}" font-size="13"
              fill="#e5e7eb" text-anchor="middle" font-weight="600">
          ${s} ${sz}
        </text>
        <text x="${midX}" y="${bfy+18}" font-size="11"
              fill="#fda4af" text-anchor="middle" font-weight="600">
          ${angleText}
        </text>
        <text x="${midX}" y="${bfy+34}" font-size="10"
              fill="#cbd5f5" text-anchor="middle">
          Î”top Ùˆ Î”bottom ØªØ·Ø¨Ù‘Ù‚Ø§Ù† Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø·Ø¹Ø© (Ø§Ù„Ø±Ø³Ù… ØªÙ…Ø«ÙŠÙ„ÙŠ).
        </text>
      </svg>
    `;
    $frontWrapper.innerHTML = svg;
  }

  // Joint Front View
  function renderJointFront(state){
    const dict = I18N[currentLang] || I18N.ar;
    const {
      s, sz, b,
      dt, db,
      pairAngle
    } = state;

    const w = 460, h = 230;
    const midX = w/2;
    const cy = h/2;

    const profileH = 130;
    const flangeTh = 16;
    const webTh = 12;

    const spanBase = 70+(b-180)*0.25;
    const flangeW = spanBase*2;

    const gapPx = 6;

    const leftInnerX = midX - gapPx/2;
    const leftOuterX = leftInnerX - flangeW;

    const rightInnerX = midX + gapPx/2;
    const rightOuterX = rightInnerX + flangeW;

    const tfy = cy - profileH/2;
    const bfy = cy + profileH/2;

    const pxTopCut = (b>0) ? flangeW * (dt/b) : 0;
    const pxBottomCut = (b>0) ? flangeW * (db/b) : 0;
    const pxTopCutClamped = Math.min(pxTopCut, flangeW*0.5);
    const pxBottomCutClamped = Math.min(pxBottomCut, flangeW*0.5);

    const leftTopX1 = leftOuterX;
    const leftTopX2 = leftInnerX - pxTopCutClamped;
    const leftBottomX1 = leftOuterX;
    const leftBottomX2 = leftInnerX - pxBottomCutClamped;

    const rightTopX1 = rightInnerX + pxTopCutClamped;
    const rightTopX2 = rightOuterX;
    const rightBottomX1 = rightInnerX + pxBottomCutClamped;
    const rightBottomX2 = rightOuterX;

    const angleText = pairAngle===0
      ? (dict.pairAngleZeroNote || "â‰ˆ 0Â°")
      : `${pairAngle.toFixed(2)}Â°`;

    // Ù…ÙŠÙ„Ø§Ù† Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„Ø²Ø§ÙˆÙŠØ©ØŒ Ù„ÙƒÙ† Ù‡Ø§Ø¯Ø¦ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø§Ø®Ù„
    let baseTilt = pairAngle / 2.5;
    if(baseTilt > 18) baseTilt = 18;

    const totalTiltLeft = -baseTilt + userTiltLeft;
    const totalTiltRight = baseTilt + userTiltRight;

    const arcR = 40;
    const angleRad = pairAngle*Math.PI/180;
    const arcX1 = midX - arcR;
    const arcY1 = cy;
    const arcX2 = midX - arcR*Math.cos(angleRad);
    const arcY2 = cy - arcR*Math.sin(angleRad);

    const svg = `
      <svg width="100%" height="${h}" viewBox="0 0 ${w} ${h}" preserveAspectRatio="xMidYMid meet">
        <defs>
          <linearGradient id="metalJoint" x1="0%" y1="0%" x2="100%">
            <stop offset="0%" stop-color="#cbd5f5"/>
            <stop offset="40%" stop-color="#e5e7eb"/>
            <stop offset="70%" stop-color="#9ca3af"/>
            <stop offset="100%" stop-color="#6b7280"/>
          </linearGradient>
          <linearGradient id="webJoint" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#e5e7eb"/>
            <stop offset="100%" stop-color="#9ca3af"/>
          </linearGradient>
          <filter id="shadowJoint" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="6" stdDeviation="6"
                          flood-color="#020617" flood-opacity="0.85"/>
          </filter>
        </defs>

        <g filter="url(#shadowJoint)">

          <!-- Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙŠØ³Ø±Ù‰ -->
          <g data-piece="left"
             style="cursor:grab"
             transform="
               translate(${userShiftLeft},0)
               translate(${leftInnerX},${cy})
               rotate(${totalTiltLeft})
               translate(${-leftInnerX},${-cy})
             ">
            <rect x="${leftTopX1}" y="${tfy}"
                  width="${leftTopX2-leftTopX1}" height="${flangeTh}"
                  fill="url(#metalJoint)" stroke="#94a3b8" stroke-width="1"/>
            <rect x="${leftBottomX1}" y="${bfy-flangeTh}"
                  width="${leftBottomX2-leftBottomX1}" height="${flangeTh}"
                  fill="url(#metalJoint)" stroke="#94a3b8" stroke-width="1"/>
            <rect x="${leftOuterX + flangeW/2 - webTh/2}" y="${tfy+flangeTh}"
                  width="${webTh}" height="${profileH-2*flangeTh}"
                  fill="url(#webJoint)" stroke="#94a3b8" stroke-width="1"/>
          </g>

          <!-- Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ -->
          <g data-piece="right"
             style="cursor:grab"
             transform="
               translate(${userShiftRight},0)
               translate(${rightInnerX},${cy})
               rotate(${totalTiltRight})
               translate(${-rightInnerX},${-cy})
             ">
            <rect x="${rightTopX1}" y="${tfy}"
                  width="${rightTopX2-rightTopX1}" height="${flangeTh}"
                  fill="url(#metalJoint)" stroke="#94a3b8" stroke-width="1"/>
            <rect x="${rightBottomX1}" y="${bfy-flangeTh}"
                  width="${rightBottomX2-rightBottomX1}" height="${flangeTh}"
                  fill="url(#metalJoint)" stroke="#94a3b8" stroke-width="1"/>
            <rect x="${rightInnerX + flangeW/2 - webTh/2}" y="${tfy+flangeTh}"
                  width="${webTh}" height="${profileH-2*flangeTh}"
                  fill="url(#webJoint)" stroke="#94a3b8" stroke-width="1"/>
          </g>

        </g>

        <!-- ÙØ±Ø§Øº Ø«Ø§Ø¨Øª Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø·Ø¹ØªÙŠÙ† -->
        <rect x="${midX-gapPx/2}" y="${tfy}"
              width="${gapPx}" height="${profileH}"
              fill="transparent" stroke="rgba(148,163,184,0.4)" stroke-dasharray="4 4"/>

        <circle cx="${midX}" cy="${cy}" r="2.5" fill="#f97373"/>

        <!-- Ù‚ÙˆØ³ Ø§Ù„Ø²Ø§ÙˆÙŠØ© -->
        <path d="M ${arcX1} ${arcY1} A ${arcR} ${arcR} 0 0 0 ${arcX2} ${arcY2}"
              fill="none" stroke="#f97373" stroke-width="2" stroke-linecap="round"/>

        <text x="${midX-arcR-6}" y="${cy-8}" font-size="11"
              fill="#fda4af" text-anchor="end" font-weight="600">
          Î¸ â‰ˆ ${angleText}
        </text>

        <text x="${w/2}" y="22" font-size="13" fill="#e5e7eb"
              text-anchor="middle" font-weight="600">
          ${s} ${sz} â€” Joint Front View
        </text>

        <text x="${w/2}" y="${h-18}" font-size="9.5" fill="#cbd5f5" text-anchor="middle">
          ${dict.jointAngleLabel || ''} ${pairAngle.toFixed(2)}Â° â€” ${dict.jointGapLabel || ''}
        </text>
      </svg>
    `;
    $jointWrapper.innerHTML = svg;
    attachJointInteraction();
  }

  // ØªÙØ§Ø¹Ù„ Ø§Ù„Ø³Ø­Ø¨/Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
  function attachJointInteraction(){
    const svg = $jointWrapper.querySelector('svg');
    if(!svg) return;
    const leftG = svg.querySelector('[data-piece="left"]');
    const rightG = svg.querySelector('[data-piece="right"]');
    if(!leftG || !rightG) return;

    const startDrag = (piece, evt)=>{
      evt.preventDefault();
      activePiece = piece;
      dragStartX = evt.clientX;
      dragStartY = evt.clientY;
      if(piece === 'left'){
        dragStartShift = userShiftLeft;
        dragStartTilt = userTiltLeft;
      } else {
        dragStartShift = userShiftRight;
        dragStartTilt = userTiltRight;
      }
      document.addEventListener('pointermove', onDragMove);
      document.addEventListener('pointerup', endDrag);
      document.addEventListener('pointercancel', endDrag);
      if(piece === 'left') leftG.style.cursor = 'grabbing';
      if(piece === 'right') rightG.style.cursor = 'grabbing';
    };

    const onDragMove = (evt)=>{
      if(!activePiece) return;
      const dx = evt.clientX - dragStartX;
      const dy = evt.clientY - dragStartY;

      let newShift = dragStartShift + dx;
      if(newShift > MAX_DRAG_SHIFT) newShift = MAX_DRAG_SHIFT;
      if(newShift < -MAX_DRAG_SHIFT) newShift = -MAX_DRAG_SHIFT;

      let newTilt = dragStartTilt - dy * DRAG_ROT_FACTOR;
      if(newTilt > MAX_DRAG_TILT) newTilt = MAX_DRAG_TILT;
      if(newTilt < -MAX_DRAG_TILT) newTilt = -MAX_DRAG_TILT;

      if(activePiece === 'left'){
        userShiftLeft = newShift;
        userTiltLeft = newTilt;
      } else {
        userShiftRight = newShift;
        userTiltRight = newTilt;
      }

      const state = buildState();
      renderJointFront(state);
    };

    const endDrag = ()=>{
      if(!activePiece) return;
      activePiece = null;
      leftG.style.cursor = 'grab';
      rightG.style.cursor = 'grab';
      document.removeEventListener('pointermove', onDragMove);
      document.removeEventListener('pointerup', endDrag);
      document.removeEventListener('pointercancel', endDrag);
    };

    leftG.addEventListener('pointerdown', e=>startDrag('left', e));
    rightG.addEventListener('pointerdown', e=>startDrag('right', e));
  }

  function calc(){
    const state = buildState();
    renderReadout(state);
    renderSingleFront(state);
    renderJointFront(state);
  }

  // EVENTS
  [$series,$size].forEach(el=>{
    el.addEventListener('input',()=>{
      mode='angle';
      calc();
    });
  });

  $angle.addEventListener('input',()=>{
    mode='angle';
    calc();
  });

  $angleRange.addEventListener('input',()=>{
    $angle.value = $angleRange.value;
    mode='angle';
    calc();
  });

  $deltaTop.addEventListener('focus',e=>e.target.select());
  $deltaBottom.addEventListener('focus',e=>e.target.select());

  $deltaTop.addEventListener('change',()=>{
    mode='cuts';
    $deltaTopRange.value = $deltaTop.value || 0;
    calc();
  });
  $deltaBottom.addEventListener('change',()=>{
    mode='cuts';
    $deltaBottomRange.value = $deltaBottom.value || 0;
    calc();
  });

  $deltaTopRange.addEventListener('input',()=>{
    mode='cuts';
    $deltaTop.value = $deltaTopRange.value;
    calc();
  });
  $deltaBottomRange.addEventListener('input',()=>{
    mode='cuts';
    $deltaBottom.value = $deltaBottomRange.value;
    calc();
  });

  $alphaTop.addEventListener('input',()=>calc());
  $alphaTopRange.addEventListener('input',()=>{
    $alphaTop.value = $alphaTopRange.value;
    calc();
  });
  $alphaBottom.addEventListener('input',()=>calc());
  $alphaBottomRange.addEventListener('input',()=>{
    $alphaBottom.value = $alphaBottomRange.value;
    calc();
  });

  $cutWingsRadios.forEach(r=>{
    r.addEventListener('change',()=>{
      mode='angle';
      calc();
    });
  });

  document.querySelectorAll('input[name="tiltDirTop"],input[name="tiltDirBottom"]').forEach(el=>{
    el.addEventListener('change',()=>calc());
  });

  $btnReset.addEventListener('click',()=>{
    mode='angle';
    $series.value='HEB';
    populateSizes();
    $size.value='180';
    $angle.value=30;
    $angleRange.value=30;
    $deltaTop.value=0;
    $deltaBottom.value=0;
    $deltaTopRange.value=0;
    $deltaBottomRange.value=0;
    $alphaTop.value=0;
    $alphaTopRange.value=0;
    $alphaBottom.value=0;
    $alphaBottomRange.value=0;
    document.querySelector('input[name="cutWings"][value="top"]').checked=true;
    document.querySelector('input[name="tiltDirTop"][value="in"]').checked=true;
    document.querySelector('input[name="tiltDirBottom"][value="in"]').checked=true;
    userTiltLeft = 0;
    userTiltRight = 0;
    userShiftLeft = 0;
    userShiftRight = 0;
    calc();
  });

  // Ø«ÙŠÙ…
  $themeToggle.addEventListener('click',()=>{
    const body = document.body;
    const isDark = body.classList.contains('theme-dark');
    if(isDark){
      body.classList.remove('theme-dark');
      body.classList.add('theme-light');
      $themeToggle.textContent='â˜€';
    }else{
      body.classList.remove('theme-light');
      body.classList.add('theme-dark');
      $themeToggle.textContent='â˜¾';
    }
  });

  // Tabs
  function setView(view){
    if(view==='single'){
      $viewSingle.classList.remove('view-hidden');
      $viewJoint.classList.add('view-hidden');
      $tabSingle.classList.add('tab-btn-active');
      $tabJoint.classList.remove('tab-btn-active');
    }else{
      $viewSingle.classList.add('view-hidden');
      $viewJoint.classList.remove('view-hidden');
      $tabSingle.classList.remove('tab-btn-active');
      $tabJoint.classList.add('tab-btn-active');
    }
  }

  $tabSingle.addEventListener('click',()=>setView('single'));
  $tabJoint.addEventListener('click',()=>setView('joint'));

  // Ù„ØºØ©
  $langButtons.forEach(btn=>{
    btn.addEventListener('click',()=>applyTranslations(btn.dataset.lang));
  });

  document.addEventListener('DOMContentLoaded',()=>{
    populateSizes();
    $size.value='180';
    applyTranslations('ar');
    setView('single');
  });
</script>

</body>
</html>
